/*! Hammer.JS - v1.0.6 - 2014-01-02
 * http://eightmedia.github.com/hammer.js
 *
 * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
 * Licensed under the MIT license */

!function(t,e){function i(){n.READY||(n.event.determineEventTypes(),n.utils.each(n.gestures,function(t){n.detection.register(t)}),n.event.onTouch(n.DOCUMENT,n.EVENT_MOVE,n.detection.detect),n.event.onTouch(n.DOCUMENT,n.EVENT_END,n.detection.detect),n.READY=!0)}var n=function(t,e){return new n.Instance(t,e||{})};n.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},n.HAS_POINTEREVENTS=t.navigator.pointerEnabled||t.navigator.msPointerEnabled,n.HAS_TOUCHEVENTS="ontouchstart"in t,n.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,n.NO_MOUSEEVENTS=n.HAS_TOUCHEVENTS&&t.navigator.userAgent.match(n.MOBILE_REGEX),n.EVENT_TYPES={},n.DIRECTION_DOWN="down",n.DIRECTION_LEFT="left",n.DIRECTION_UP="up",n.DIRECTION_RIGHT="right",n.POINTER_MOUSE="mouse",n.POINTER_TOUCH="touch",n.POINTER_PEN="pen",n.EVENT_START="start",n.EVENT_MOVE="move",n.EVENT_END="end",n.DOCUMENT=t.document,n.plugins=n.plugins||{},n.gestures=n.gestures||{},n.READY=!1,n.utils={extend:function(t,i,n){for(var o in i)t[o]!==e&&n||(t[o]=i[o]);return t},each:function(t,i,n){var o,r;if("forEach"in t)t.forEach(i,n);else if(t.length!==e){for(o=0,r=t.length;r>o;o++)if(i.call(n,t[o],o,t)===!1)return}else for(o in t)if(t.hasOwnProperty(o)&&i.call(n,t[o],o,t)===!1)return},hasParent:function(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1},getCenter:function(t){var e=[],i=[];return n.utils.each(t,function(t){e.push("undefined"!=typeof t.clientX?t.clientX:t.pageX),i.push("undefined"!=typeof t.clientY?t.clientY:t.pageY)}),{pageX:(Math.min.apply(Math,e)+Math.max.apply(Math,e))/2,pageY:(Math.min.apply(Math,i)+Math.max.apply(Math,i))/2}},getVelocity:function(t,e,i){return{x:Math.abs(e/t)||0,y:Math.abs(i/t)||0}},getAngle:function(t,e){var i=e.pageY-t.pageY,n=e.pageX-t.pageX;return 180*Math.atan2(i,n)/Math.PI},getDirection:function(t,e){var i=Math.abs(t.pageX-e.pageX),o=Math.abs(t.pageY-e.pageY);return i>=o?t.pageX-e.pageX>0?n.DIRECTION_LEFT:n.DIRECTION_RIGHT:t.pageY-e.pageY>0?n.DIRECTION_UP:n.DIRECTION_DOWN},getDistance:function(t,e){var i=e.pageX-t.pageX,n=e.pageY-t.pageY;return Math.sqrt(i*i+n*n)},getScale:function(t,e){return t.length>=2&&e.length>=2?this.getDistance(e[0],e[1])/this.getDistance(t[0],t[1]):1},getRotation:function(t,e){return t.length>=2&&e.length>=2?this.getAngle(e[1],e[0])-this.getAngle(t[1],t[0]):0},isVertical:function(t){return t==n.DIRECTION_UP||t==n.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(t,e){e&&t&&t.style&&(n.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(i){n.utils.each(e,function(e){i&&(e=i+e.substring(0,1).toUpperCase()+e.substring(1)),e in t.style&&(t.style[e]=e)})}),"none"==e.userSelect&&(t.onselectstart=function(){return!1}),"none"==e.userDrag&&(t.ondragstart=function(){return!1}))}},n.Instance=function(t,e){var o=this;return i(),this.element=t,this.enabled=!0,this.options=n.utils.extend(n.utils.extend({},n.defaults),e||{}),this.options.stop_browser_behavior&&n.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),n.event.onTouch(t,n.EVENT_START,function(t){o.enabled&&n.detection.startDetect(o,t)}),this},n.Instance.prototype={on:function(t,e){var i=t.split(" ");return n.utils.each(i,function(t){this.element.addEventListener(t,e,!1)},this),this},off:function(t,e){var i=t.split(" ");return n.utils.each(i,function(t){this.element.removeEventListener(t,e,!1)},this),this},trigger:function(t,e){e||(e={});var i=n.DOCUMENT.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e;var o=this.element;return n.utils.hasParent(e.target,o)&&(o=e.target),o.dispatchEvent(i),this},enable:function(t){return this.enabled=t,this}};var o=null,r=!1,s=!1;n.event={bindDom:function(t,e,i){var o=e.split(" ");n.utils.each(o,function(e){t.addEventListener(e,i,!1)})},onTouch:function(t,e,i){var a=this;this.bindDom(t,n.EVENT_TYPES[e],function(h){var c=h.type.toLowerCase();if(!c.match(/mouse/)||!s){c.match(/touch/)||c.match(/pointerdown/)||c.match(/mouse/)&&1===h.which?r=!0:c.match(/mouse/)&&!h.which&&(r=!1),c.match(/touch|pointer/)&&(s=!0);var l=0;r&&(n.HAS_POINTEREVENTS&&e!=n.EVENT_END?l=n.PointerEvent.updatePointer(e,h):c.match(/touch/)?l=h.touches.length:s||(l=c.match(/up/)?0:1),l>0&&e==n.EVENT_END?e=n.EVENT_MOVE:l||(e=n.EVENT_END),(l||null===o)&&(o=h),i.call(n.detection,a.collectEventData(t,e,a.getTouchList(o,e),h)),n.HAS_POINTEREVENTS&&e==n.EVENT_END&&(l=n.PointerEvent.updatePointer(e,h))),l||(o=null,r=!1,s=!1,n.PointerEvent.reset())}})},determineEventTypes:function(){var t;t=n.HAS_POINTEREVENTS?n.PointerEvent.getEvents():n.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],n.EVENT_TYPES[n.EVENT_START]=t[0],n.EVENT_TYPES[n.EVENT_MOVE]=t[1],n.EVENT_TYPES[n.EVENT_END]=t[2]},getTouchList:function(t){return n.HAS_POINTEREVENTS?n.PointerEvent.getTouchList():t.touches?t.touches:(t.identifier=1,[t])},collectEventData:function(t,e,i,o){var r=n.POINTER_TOUCH;return(o.type.match(/mouse/)||n.PointerEvent.matchType(n.POINTER_MOUSE,o))&&(r=n.POINTER_MOUSE),{center:n.utils.getCenter(i),timeStamp:(new Date).getTime(),target:o.target,touches:i,eventType:e,pointerType:r,srcEvent:o,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return n.detection.stopDetect()}}}},n.PointerEvent={pointers:{},getTouchList:function(){var t=this,e=[];return n.utils.each(t.pointers,function(t){e.push(t)}),e},updatePointer:function(t,e){return t==n.EVENT_END?this.pointers={}:(e.identifier=e.pointerId,this.pointers[e.pointerId]=e),Object.keys(this.pointers).length},matchType:function(t,e){if(!e.pointerType)return!1;var i=e.pointerType,o={};return o[n.POINTER_MOUSE]=i===e.MSPOINTER_TYPE_MOUSE||i===n.POINTER_MOUSE,o[n.POINTER_TOUCH]=i===e.MSPOINTER_TYPE_TOUCH||i===n.POINTER_TOUCH,o[n.POINTER_PEN]=i===e.MSPOINTER_TYPE_PEN||i===n.POINTER_PEN,o[t]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},n.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(t,e){this.current||(this.stopped=!1,this.current={inst:t,startEvent:n.utils.extend({},e),lastEvent:!1,name:""},this.detect(e))},detect:function(t){if(this.current&&!this.stopped){t=this.extendEventData(t);var e=this.current.inst.options;return n.utils.each(this.gestures,function(i){return this.stopped||e[i.name]===!1||i.handler.call(i,t,this.current.inst)!==!1?void 0:(this.stopDetect(),!1)},this),this.current&&(this.current.lastEvent=t),t.eventType==n.EVENT_END&&!t.touches.length-1&&this.stopDetect(),t}},stopDetect:function(){this.previous=n.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(t){var e=this.current.startEvent;!e||t.touches.length==e.touches.length&&t.touches!==e.touches||(e.touches=[],n.utils.each(t.touches,function(t){e.touches.push(n.utils.extend({},t))}));var i,o,r=t.timeStamp-e.timeStamp,s=t.center.pageX-e.center.pageX,a=t.center.pageY-e.center.pageY,h=n.utils.getVelocity(r,s,a);return"end"===t.eventType?(i=this.current.lastEvent&&this.current.lastEvent.interimAngle,o=this.current.lastEvent&&this.current.lastEvent.interimDirection):(i=this.current.lastEvent&&n.utils.getAngle(this.current.lastEvent.center,t.center),o=this.current.lastEvent&&n.utils.getDirection(this.current.lastEvent.center,t.center)),n.utils.extend(t,{deltaTime:r,deltaX:s,deltaY:a,velocityX:h.x,velocityY:h.y,distance:n.utils.getDistance(e.center,t.center),angle:n.utils.getAngle(e.center,t.center),interimAngle:i,direction:n.utils.getDirection(e.center,t.center),interimDirection:o,scale:n.utils.getScale(e.touches,t.touches),rotation:n.utils.getRotation(e.touches,t.touches),startEvent:e}),t},register:function(t){var i=t.defaults||{};return i[t.name]===e&&(i[t.name]=!0),n.utils.extend(n.defaults,i,!0),t.index=t.index||1e3,this.gestures.push(t),this.gestures.sort(function(t,e){return t.index<e.index?-1:t.index>e.index?1:0}),this.gestures}},n.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(t,e){if(n.detection.current.name!=this.name&&this.triggered)return e.trigger(this.name+"end",t),void(this.triggered=!1);if(!(e.options.drag_max_touches>0&&t.touches.length>e.options.drag_max_touches))switch(t.eventType){case n.EVENT_START:this.triggered=!1;break;case n.EVENT_MOVE:if(t.distance<e.options.drag_min_distance&&n.detection.current.name!=this.name)return;if(n.detection.current.name!=this.name&&(n.detection.current.name=this.name,e.options.correct_for_drag_min_distance&&t.distance>0)){var i=Math.abs(e.options.drag_min_distance/t.distance);n.detection.current.startEvent.center.pageX+=t.deltaX*i,n.detection.current.startEvent.center.pageY+=t.deltaY*i,t=n.detection.extendEventData(t)}(n.detection.current.lastEvent.drag_locked_to_axis||e.options.drag_lock_to_axis&&e.options.drag_lock_min_distance<=t.distance)&&(t.drag_locked_to_axis=!0);var o=n.detection.current.lastEvent.direction;t.drag_locked_to_axis&&o!==t.direction&&(t.direction=n.utils.isVertical(o)?t.deltaY<0?n.DIRECTION_UP:n.DIRECTION_DOWN:t.deltaX<0?n.DIRECTION_LEFT:n.DIRECTION_RIGHT),this.triggered||(e.trigger(this.name+"start",t),this.triggered=!0),e.trigger(this.name,t),e.trigger(this.name+t.direction,t),(e.options.drag_block_vertical&&n.utils.isVertical(t.direction)||e.options.drag_block_horizontal&&!n.utils.isVertical(t.direction))&&t.preventDefault();break;case n.EVENT_END:this.triggered&&e.trigger(this.name+"end",t),this.triggered=!1}}},n.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(t,e){switch(t.eventType){case n.EVENT_START:clearTimeout(this.timer),n.detection.current.name=this.name,this.timer=setTimeout(function(){"hold"==n.detection.current.name&&e.trigger("hold",t)},e.options.hold_timeout);break;case n.EVENT_MOVE:t.distance>e.options.hold_threshold&&clearTimeout(this.timer);break;case n.EVENT_END:clearTimeout(this.timer)}}},n.gestures.Release={name:"release",index:1/0,handler:function(t,e){t.eventType==n.EVENT_END&&e.trigger(this.name,t)}},n.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(t,e){if(t.eventType==n.EVENT_END){if(e.options.swipe_max_touches>0&&t.touches.length<e.options.swipe_min_touches&&t.touches.length>e.options.swipe_max_touches)return;(t.velocityX>e.options.swipe_velocity||t.velocityY>e.options.swipe_velocity)&&(e.trigger(this.name,t),e.trigger(this.name+t.direction,t))}}},n.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(t,e){if(t.eventType==n.EVENT_END&&"touchcancel"!=t.srcEvent.type){var i=n.detection.previous,o=!1;if(t.deltaTime>e.options.tap_max_touchtime||t.distance>e.options.tap_max_distance)return;i&&"tap"==i.name&&t.timeStamp-i.lastEvent.timeStamp<e.options.doubletap_interval&&t.distance<e.options.doubletap_distance&&(e.trigger("doubletap",t),o=!0),(!o||e.options.tap_always)&&(n.detection.current.name="tap",e.trigger(n.detection.current.name,t))}}},n.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(t,e){return e.options.prevent_mouseevents&&t.pointerType==n.POINTER_MOUSE?void t.stopDetect():(e.options.prevent_default&&t.preventDefault(),void(t.eventType==n.EVENT_START&&e.trigger(this.name,t)))}},n.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(t,e){if(n.detection.current.name!=this.name&&this.triggered)return e.trigger(this.name+"end",t),void(this.triggered=!1);if(!(t.touches.length<2))switch(e.options.transform_always_block&&t.preventDefault(),t.eventType){case n.EVENT_START:this.triggered=!1;break;case n.EVENT_MOVE:var i=Math.abs(1-t.scale),o=Math.abs(t.rotation);if(i<e.options.transform_min_scale&&o<e.options.transform_min_rotation)return;n.detection.current.name=this.name,this.triggered||(e.trigger(this.name+"start",t),this.triggered=!0),e.trigger(this.name,t),o>e.options.transform_min_rotation&&e.trigger("rotate",t),i>e.options.transform_min_scale&&(e.trigger("pinch",t),e.trigger("pinch"+(t.scale<1?"in":"out"),t));break;case n.EVENT_END:this.triggered&&e.trigger(this.name+"end",t),this.triggered=!1}}},n.plugins.fakeMultitouch=function(){var t=!1;n.HAS_POINTEREVENTS=navigator.msPointerEnabled&&navigator.msMaxTouchPoints&&navigator.msMaxTouchPoints>=1,n.event.getTouchList=function(e,i){if(n.HAS_POINTEREVENTS)return n.PointerEvent.getTouchList();if(e.touches)return e.touches;if(i==n.EVENT_START&&(t=!1),e.shiftKey){t||(t={pageX:e.pageX,pageY:e.pageY});var o=t.pageX-e.pageX,r=t.pageY-e.pageY;return[{identifier:1,pageX:t.pageX-o-50,pageY:t.pageY-r+50,target:e.target},{identifier:2,pageX:t.pageX+o+50,pageY:t.pageY+r-50,target:e.target}]}return t=!1,[{identifier:1,pageX:e.pageX,pageY:e.pageY,target:e.target}]}},n.plugins.showTouches=function(t){function e(){for(var t in o)o.hasOwnProperty(t)&&!r[t]&&(document.body.removeChild(o[t]),delete o[t])}var i="position:absolute;z-index:9999;left:0;top:0;height:14px;width:14px;border:solid 2px #777;background:rgba(255,255,255,.7);border-radius:20px;pointer-events:none;margin-top:-9px;margin-left:-9px;",o={},r={};n.detection.register({name:"show_touches",priority:0,handler:function(s){if(r={},s.pointerType!=n.POINTER_MOUSE&&!t)return void e();for(var a=0,h=s.touches.length;h>a;a++){var c=s.touches[a],l=c.identifier;if(r[l]=c,!o[l]){var u=document.createElement("div");u.setAttribute("style",i),document.body.appendChild(u),o[l]=u}o[l].style.left=c.pageX+"px",o[l].style.top=c.pageY+"px"}e()}})},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("hammer",[],function(){return n}):"object"==typeof module&&"object"==typeof module.exports?module.exports=n:t.Hammer=n}(this),define("scalejs.canvas/utils",[],function(){var t={left:function(){return 0},top:function(){return 0},center:function(t){return-t/2},right:function(t){return-t},bottom:function(t){return-t}},e={left:function(t){return t},top:function(t){return t},center:function(t,e){return t-e/2},right:function(t,e){return t-e},bottom:function(t,e){return t-e}};return{getOffset:t,applyOffset:e}}),define("scalejs.canvas/group",["./utils"],function(t){return function(e){function i(t){this.type="group",this.className="group",this.parent=t.parent||e,this.id=t.id||t.parent.children.length,this.data=t.data||{},this.fontFamily=t.fontFamily||"",this.fontSize=t.fontSize||0,this.originX=t.originX||"left",this.originY=t.originY||"top",this.left=t.left||0,this.top=t.top||0,this.width=t.width||0,this.height=t.height||0,this.angle=t.angle||0,this.scaleX=t.scaleX||1,this.scaleY=t.scaleY||1,this.backFill=t.backFill||"",this.opacity=t.opacity||1,this.offset={left:0,top:0},this.pos={left:0,top:0},this.extents={left:0,top:0,right:0,bottom:0},this.children=[]}return i.prototype.getExtents=function(){return this.extents},i.prototype.calcBounds=function(){var i,n;this.fontFamily&&this.fontSize?(this.font=this.fontSize+"px "+this.fontFamily,this.font!==e.curFont&&(i=e.curFont,n=e.curFontSize,e.context.save(),e.context.font=this.font,e.curFont=this.font,e.curFontSize=this.fontSize)):this.font=void 0;for(var o=0;o<this.children.length;o++)this.children[o].calcBounds();i&&(e.curFont=i,e.curFontSize=n,e.context.restore()),this.offset.left=t.getOffset[this.originX](this.width),this.offset.top=t.getOffset[this.originY](this.height),this.pos.left=this.left+this.offset.left,this.pos.top=this.top+this.offset.top,this.radianAngle=this.angle*Math.PI/180},i.prototype.render=function(){if(!(this.opacity<=0)){if(e.context.save(),this.opacity<1&&(e.context.globalAlpha*=this.opacity),e.context.translate(this.pos.left,this.pos.top),e.context.scale(this.scaleX,this.scaleY),e.context.rotate(this.radianAngle),this.backFill&&this.width>0&&this.height>0&&(e.context.fillStyle=this.backFill,e.context.fillRect(0,0,this.width,this.height)),this.font&&this.font!==e.curFont){var t=e.curFont,i=e.curFontSize;e.context.font=this.font,e.curFont=this.font,e.curFontSize=this.fontSize;for(var n=0;n<this.children.length;n++)this.children[n].render();e.curFont=t,e.curFontSize=i}else for(var n=0;n<this.children.length;n++)this.children[n].render();e.context.restore()}},i.prototype.isPointIn=function(t,e,i){t-=this.pos.left,e-=this.pos.top,t/=this.scaleX,e/=this.scaleY;var n=Math.sin(-this.radianAngle),o=Math.cos(-this.radianAngle),r=t;if(t=t*o-e*n,e=r*n+e*o,this.backFill)return t>=0&&e>=0&&t<=this.width&&e<=this.height;for(var s=0;s<this.children.length;s++)if(this.children[s].isPointIn(t,e,i))return!0;return!1},i.prototype.touchEventHandler=function(t,e,i){t-=this.pos.left,e-=this.pos.top,t/=this.scaleX,e/=this.scaleY;var n=Math.sin(-this.radianAngle),o=Math.cos(-this.radianAngle),r=t;t=t*o-e*n,e=r*n+e*o;for(var s=0;s<this.children.length;s++)this.children[s].isPointIn(t,e,i)&&this.children[s].touchEventHandler(t,e,i);this[i.name]&&this[i.name](this.data.data)},i.prototype.remove=function(){this.parent.children.splice(this.parent.children.indexOf(this),1)},i}}),define("scalejs.canvas/rect",["./utils"],function(t){return function(e){function i(t){this.type="obj",this.className="rect",this.parent=t.parent||e,this.id=t.id||t.parent.children.length,this.data=t.data||{},this.originX=t.originX||"left",this.originY=t.originY||"top",this.left=t.left||0,this.top=t.top||0,this.width=t.width||0,this.height=t.height||0,this.fill=t.fill||"#000",this.offset={left:0,top:0},this.pos={left:0,top:0},this.extents={left:0,top:0,right:0,bottom:0}}return i.prototype.getExtents=function(){return this.extents},i.prototype.calcBounds=function(){this.offset.left=t.getOffset[this.originX](this.width),this.offset.top=t.getOffset[this.originY](this.height),this.pos.left=this.left+this.offset.left,this.pos.top=this.top+this.offset.top,this.extents.left=this.pos.left,this.extents.top=this.pos.top,this.extents.right=this.pos.left+this.width,this.extents.bottom=this.pos.top+this.height},i.prototype.render=function(){this.width>0&&this.height>0&&(e.context.fillStyle=this.fill,e.context.fillRect(this.pos.left,this.pos.top,this.width,this.height))},i.prototype.isPointIn=function(t,e){return t>=this.extents.left&&e>=this.extents.top&&t<=this.extents.right&&e<=this.extents.bottom},i.prototype.touchEventHandler=function(t,e,i){this[i.name]&&this[i.name](this.data.data)},i.prototype.remove=function(){this.parent.children.splice(this.parent.children.indexOf(this),1)},i}}),define("scalejs.canvas/text",["./utils"],function(t){return function(e){function i(t){this.type="obj",this.className="text",this.parent=t.parent||e,this.id=t.id||t.parent.children.length,this.data=t.data||{},this.fontFamily=t.fontFamily||"",this.fontSize=t.fontSize||0,this.text=t.text||"",this.originX=t.originX||"left",this.originY=t.originY||"top",this.left=t.left||0,this.top=t.top||0,this.width=t.width||0,this.height=t.height||0,this.angle=t.angle||0,this.fill=t.fill||"#000",this.offset={left:0,top:0},this.pos={left:0,top:0},this.extents={left:0,top:0,right:0,bottom:0}}return i.prototype.opacity=1,i.prototype.setText=function(t){this.fontFamily&&this.fontSize?(this.font=this.fontSize+"px "+this.fontFamily,this.height=this.fontSize):(this.font=void 0,this.height=e.curFontSize),!this.font||this.font===this.calcFont&&this.calcText===this.text?this.font||e.curFont===this.calcFont&&this.calcText===this.text||(this.text=t,this.width=e.context.measureText(t||"").width,this.calcText=this.text,this.calcFont=e.curFont):(e.context.save(),e.context.font=this.font,this.text=t,this.width=e.context.measureText(t||"").width,e.context.restore(),this.calcText=this.text,this.calcFont=this.font)},i.prototype.getExtents=function(){return this.extents},i.prototype.calcBounds=function(){this.setText(this.text),this.offset.left=t.getOffset[this.originX](this.width),this.offset.top=t.getOffset[this.originY](this.height)+this.height,this.pos.left=this.left+this.offset.left,this.pos.top=this.top+this.offset.top,this.extents.left=this.pos.left,this.extents.right=this.pos.left,this.extents.top=this.pos.top+this.width,this.extents.bottom=this.pos.top+this.height},i.prototype.render=function(){this.opacity>0&&this.text.length>0&&(e.context.save(),this.font&&this.font!==e.curFont&&(e.context.font=this.font),this.fill&&(e.context.fillStyle=this.fill),this.opacity<1&&(e.context.globalAlpha*=this.opacity),e.context.translate(this.left,this.top),this.angle&&e.context.rotate(this.angle*Math.PI/180),e.context.fillText(this.text,this.offset.left,this.offset.top),e.context.restore())},i.prototype.isPointIn=function(t,e){return t>=this.extents.left&&e>=this.extents.top&&t<=this.extents.right&&e<=this.extents.bottom},i.prototype.touchEventHandler=function(t,e,i){this[i.name]&&this[i.name](this.data.data)},i.prototype.remove=function(){this.parent.children.splice(this.parent.children.indexOf(this),1)},i}}),define("scalejs.canvas/arc",["./utils"],function(){var t=.5*Math.PI;return function(e){function i(t){this.type="obj",this.className="arc",this.parent=t.parent||e,this.id=t.id||t.parent.children.length,this.data=t.data||{},this.originX=t.originX||"center",this.originY=t.originY||"center",this.left=t.left||0,this.top=t.top||0,this.width=t.width||0,this.height=t.height||0,this.radius=0,this.innerRadius=t.innerRadius||0,this.outerRadius=t.outerRadius||0,this.thickness=0,this.startAngle=t.startAngle||0,this.endAngle=t.endAngle||0,this.fill=t.fill||"#000",this.opacity=t.opacity||1,this.offset={left:0,top:0},this.pos={left:0,top:0},this.extents={left:0,top:0,right:0,bottom:0}}return i.prototype.getExtents=function(){return this.extents},i.prototype.calcBounds=function(){this.width=this.height=2*this.outerRadius,this.offset.left=this.left,this.offset.top=this.top,this.extents.left=this.offset.left-this.outerRadius,this.extents.right=this.offset.left+this.outerRadius,this.extents.top=this.offset.top-this.outerRadius,this.extents.bottom=this.offset.top+this.outerRadius,this.thickness=this.outerRadius-this.innerRadius,this.radius=this.thickness/2+this.innerRadius},i.prototype.render=function(){this.opacity>0&&0!==this.thickness&&this.endAngle!==this.startAngle&&(e.context.beginPath(),this.fill&&(e.context.strokeStyle=this.fill),this.opacity<1&&(e.context.globalAlpha*=this.opacity),e.context.lineWidth=this.thickness,e.context.arc(this.offset.left,this.offset.top,this.radius,this.startAngle-t,this.endAngle-t),e.context.stroke())},i.prototype.isPointIn=function(e,i){var n=(e-this.offset.left)*(e-this.offset.left)+(i-this.offset.top)*(i-this.offset.top),o=Math.atan2(i-this.offset.top,e-this.offset.left)+t;return 0>o&&(o+=2*Math.PI),n<=this.outerRadius*this.outerRadius&&n>=this.innerRadius*this.innerRadius&&o>=this.startAngle&&o<=this.endAngle},i.prototype.touchEventHandler=function(t,e,i){this[i.name]&&this[i.name](this.data.data)},i.prototype.remove=function(){this.parent.children.splice(this.parent.children.indexOf(this),1)},i}}),define("scalejs.canvas/selector",["./group","./rect","./text","./arc"],function(t,e,i,n){var o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60),!0};return function(r){function s(t){this.isTransition=t.isTransition||!1,this.durationTime=t.durationTime||250,this.easeFunc=t.easeFunc||function(t){return t},this.endFunc=void 0,this.object=t.object||r,this.objects=t.objects||[],this.enterObjects=t.enterObjects||[],this.updateObjects=t.updateObjects||[],this.exitObjects=t.exitObjects||[]}var a,h={group:t(r),rect:e(r),text:i(r),arc:n(r)};return s.prototype.select=function(t){var e,i,n,o=[];for(i=0;i<this.objects.length;i++)if(e=this.objects[i],void 0!==e.children&&e.children.length>0)for(n=0;n<e.children.length;n++)if(e.children[n].className===t){o.push(e.children[n]);break}return new s({isTransition:this.isTransition,durationTime:this.durationTime,easeFunc:this.easeFunc,object:o.length>0?o[0].parent:this.objects.length>0?this.objects[0]:this.object,objects:o})},s.prototype.selectAll=function(t){var e,i,n,o=[];for(i=0;i<this.objects.length;i++)if(e=this.objects[i],void 0!==e.children&&e.children.length>0)for(n=0;n<e.children.length;n++)e.children[n].className===t&&o.push(e.children[n]);return new s({isTransition:this.isTransition,durationTime:this.durationTime,easeFunc:this.easeFunc,object:o.length>0?o[0].parent:this.objects.length>0?this.objects[0]:this.object,objects:o})},s.prototype.filter=function(t){for(var e=[],i=0;i<this.objects.length;i++)t.call(this.objects[i],this.objects[i].data.data)&&e.push(this.objects[i]);return new s({isTransition:this.isTransition,durationTime:this.durationTime,easeFunc:this.easeFunc,object:e.length>0?e[0].parent:this.objects.length>0?this.objects[0]:this.object,objects:e})},s.prototype.data=function(t,e){for(var i={},n=0;n<t.length;n++){var o=e(t[n]);t[n]={id:o,data:t[n]},i[o]=t[n]}this.exitObjects=[],this.updateObjects=this.objects,this.objects=[];for(var n=0;n<this.updateObjects.length;n++)i[this.updateObjects[n].data.id]?(this.updateObjects[n].data.data=i[this.updateObjects[n].data.id].data,i[this.updateObjects[n].data.id]=void 0,this.objects.push(this.updateObjects[n])):(this.exitObjects.push(this.updateObjects[n]),this.updateObjects.splice(n,1),n--);for(var n=0;n<t.length;n++)i[t[n].id]||(t.splice(n,1),n--);return this.enterObjects=t,this},s.prototype.enter=function(){return{parentSelector:this,append:function(t,e){return e=e||{},new s({isTransition:this.parentSelector.isTransition,durationTime:this.parentSelector.durationTime,easeFunc:this.parentSelector.easeFunc,objects:this.parentSelector.enterObjects.map(function(i){e.parent=this.parentSelector.object,e.data=i;var n=new h[t](e);return this.parentSelector.object.children.push(n),n},this)})}}},s.prototype.update=function(){var t=new s(this);return t.objects=this.updateObjects,t},s.prototype.exit=function(){var t=new s(this);return t.objects=this.exitObjects,t},s.prototype.on=function(t,e){return t="on"+t,this.objects.forEach(function(i){i[t]=e}),this},s.prototype.append=function(t,e){e=e||{};var i=new s(this);return i.objects=this.objects.map(function(i){e.parent=i,e.data=i.data;var n=new h[t](e);return i.children.push(n),n}),i},s.prototype.remove=function(){return this.objects.forEach(function(t){t.parent.children.splice(t.parent.children.indexOf(t),1)}),this.objects=[],this},s.prototype.attr=function(t,e){return this.objects.forEach(function(i){e instanceof Function&&(e=e.call(i,i.data.data)),i["set"+t]instanceof Function?i["set"+t](e):i[t]=e}),this},s.prototype.sort=function(t){return this.objects.sort(function(e,i){return t(e.data.data,i.data.data)}),this},s.prototype.order=function(){return this.objects.forEach(function(t){t.parent.children.splice(t.parent.children.indexOf(t),1),t.parent.children.push(t)}),this},s.prototype.each=function(t,e){return void 0===e||"start"===e?this.objects.forEach(function(e){t.call(e,e.data.data)}):"end"===e&&this.objects.forEach(function(e){e.tweenEndFunc=t}),this},s.prototype.transition=function(){var t=new s(this);return t.isTransition=!0,t.objects.forEach(function(t){t.tweenEndFunc=void 0}),t},s.prototype.duration=function(t){return this.durationTime=t,this},s.prototype.ease=function(t){return this.easeFunc=t,this},s.prototype.tween=function(t,e){var i,n,s=(new Date).getTime(),a=s+this.durationTime;for(n=0;n<this.objects.length;n++)i=this.objects[n],i.animationIndex>=0||(i.animationIndex=r.animations.length,r.animations[i.animationIndex]=i),i.tweenFunc=e.call(i,i.data.data),i.easeFunc=this.easeFunc,i.timeStart=s,i.timeEnd=a,i.duration=this.durationTime;return void 0===r.requestFrameID&&r.animations.length>0&&(r.requestFrameID=o(function(){r.onAnimationFrame()})),this},s.prototype.startRender=function(){},s.prototype.pumpRender=function(){return r.pumpRender(),a},a=new s({objects:[r]}),a[0]=[r.element],a}}),define("scalejs.canvas/canvas",["hammer","./selector"],function(t,e){function i(t){this.type="canvas",this.className="canvas",this.element=t,this.context=t.getContext("2d"),this.parent=this,this.width=t.width,this.height=t.height,this.children=[],this.animations=[],this.requestFrameID=void 0,this.curFont="",this.curFontSize=0}function n(n){function o(t){if(t.gesture&&(t.gesture.preventDefault(),1===t.gesture.touches.length)){var e,i=t.gesture.touches[0],n=i.target.style.display;i.target.style.display="",e=i.target.getBoundingClientRect(),i.target.style.display=n,t.offsetX=i.pageX-e.left,t.offsetY=i.pageY-e.top,t.name="on"+t.type;for(var o=0;o<r.children.length;o++)r.children[o].isPointIn(t.offsetX,t.offsetY,t)&&r.children[o].touchEventHandler(t.offsetX,t.offsetY,t)}}var r=new i(n),s=t(r.element,{prevent_default:!0,drag_min_distance:10,hold_threshold:10});return s.on("hold tap doubletap touch release",o),e(r)}var o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60),!0};return i.prototype.setwidth=function(t){this.element.width=t,this.width=t},i.prototype.setheight=function(t){this.element.height=t,this.height=t},i.prototype.onAnimationFrame=function(){if(this.animations.length<=0||this.width<=0||this.height<=0)return void(this.requestFrameID=void 0);var t=this;this.requestFrameID=o(function(){t.onAnimationFrame()});for(var e,i=(new Date).getTime(),n=0;n<this.animations.length;n++){e=this.animations[n];var r=Math.min((i-e.timeStart)/e.duration,1);e.tweenFunc(e.easeFunc(r)),i>=e.timeEnd?(e.animationIndex=void 0,e.tweenEndFunc&&e.tweenEndFunc(e.data.data),this.animations.splice(n,1),n--):e.animationIndex=n}this.render()},i.prototype.render=i.prototype.pumpRender=function(){if(!(this.width<=0||this.height<=0)){this.context.setTransform(1,0,0,1,0,0),this.context.font="40px Times New Roman",this.curFont="40px Times New Roman",this.curFontSize=40;for(var t=0;t<this.children.length;t++)this.children[t].calcBounds();this.context.clearRect(0,0,this.element.width,this.element.height);for(var t=0;t<this.children.length;t++)this.children[t].render()}},i.prototype.startRender=function(){console.warn("canvas.startRender is deprecated!")},{select:n}}),define("scalejs.canvas",["scalejs!core","./scalejs.canvas/canvas"],function(t,e){return t.registerExtension({canvas:e}),e}),define("scalejs.visualization-d3/treemap",["d3"],function(t){function e(){function t(t){return(t-e[0])/n*o+i[0]}var e=[0,1],i=[0,1],n=1,o=1;return t.domain=function(i){return arguments.length?(e=i,n=e[1]-e[0],t):e},t.range=function(e){return arguments.length?(i=e,o=i[1]-i[0],t):i},t}return function(){function i(t){for(var e=[];t!==_;)e.push(t),t=t.parent;return e.push(t),e}function n(t,e){for(var i=0;e.indexOf(t)<0;)i+=1,t=t.parent;return i}function o(t,e){if(!t.parent)return{x:t.x,y:t.y,dx:t.dx,dy:t.dy};var i=R/O,n=R/S,r=o(t.parent);return e?{x:r.dx/t.parent.dx*(t.x-t.parent.x)+r.x+i/2,y:r.dy/t.parent.dy*(t.y-t.parent.y)+r.y+n/2,dx:r.dx/t.parent.dx*t.dx-i,dy:r.dy/t.parent.dy*t.dy-n}:{x:r.dx/t.parent.dx*(t.x-t.parent.x)+r.x+i,y:r.dy/t.parent.dy*(t.y-t.parent.y)+r.y+n,dx:r.dx/t.parent.dx*t.dx-2*i,dy:r.dy/t.parent.dy*t.dy-2*n}}function r(t){var e,i=1;return 0===t.indexOf("rgba")&&(e=t.substring(5,t.length-1).replace(/ /g,"").split(","),i=Number(e.pop()),t="rgb("+e.join(",")+")"),{color:t,opacity:i}}function s(e){return function(i){var n,s,a,h,c=o(i,i),l=i.children&&i.lvl<_.curMaxLevel?M(i.lvl/(_.maxlvl-1)):i.color,u=r(l),d=t.interpolate(this.backFill,u.color),p=t.interpolate(this.opacity,e*u.opacity),f=this;
return i.sx=b(c.x),i.sy=w(c.y),i.sdx=Math.max(O*c.dx,0),i.sdy=Math.max(S*c.dy,0),n=t.interpolate(this.left,i.sx),s=t.interpolate(this.top,i.sy),a=t.interpolate(this.width,i.sdx),h=t.interpolate(this.height,i.sdy),l!==this.backFill?function(t){f.left=n(t),f.top=s(t),f.width=a(t),f.height=h(t),f.backFill=d(t),f.opacity=p(t)}:function(t){f.left=n(t),f.top=s(t),f.width=a(t),f.height=h(t),f.opacity=p(t)}}}function a(){return function(e){var i,n=t.interpolate(this.left,e.sdx/2),o=t.interpolate(this.top,e.sdy/2),s=r(e.fontColor),a=t.interpolate(this.fill,s.color),h=this;return i=p.allowTextOverflow?t.interpolate(this.opacity,e.children&&e.lvl<_.curMaxLevel?0:s.opacity):t.interpolate(this.opacity,!(e.children&&e.lvl<_.curMaxLevel)&&e.sdx-1>=this.width&&e.sdy-1>=this.height?s.opacity:0),this.fontFamily=e.fontFamily,this.fontSize=e.fontSize,function(t){h.left=n(t),h.top=o(t),h.opacity=i(t),h.fill=a(t)}}}function h(t,e,i,n){t.filter(function(t){return!(t.children&&t.lvl<_.curMaxLevel)}).on("touch",m).on("hold",x).on("release",y).on("tap",function(t){v(t.parent||t)}),t.transition().duration(n).tween("groupTween",s(1)),e.transition().duration(n).tween("textTween",a(i))}function c(e,s){s=void 0!==s?s:1e3,_=g();var c,l,u,d,f,m,v=i(e);c=P.size([E,T]).sort(_.sortBy).nodes(_).filter(function(t){return n(t,v)<_.maxVisibleLevels}).sort(function(t,e){return t.depth===e.depth?e.value-t.value:t.depth-e.depth}),l=N.selectAll("group").data(c,function(t){return t.id}),u=l.enter().append("group").each(function(t){var e=t.parent||t;this.left=b(e.x)+O*e.dx/2,this.top=w(e.y)+S*e.dy/2;var i=r(t.children&&t.lvl<_.curMaxLevel?M(t.lvl/(_.maxlvl-1)):t.color);this.backFill=i.color,this.opacity=0}),f=u.append("text").each(function(t){this.originX="center",this.originY="center",this.left=0,this.top=0,this.fontFamily=t.fontFamily,this.fontSize=t.fontSize;var e=r(t.fontColor);this.fill=e.color,this.setText(t.name),this.opacity=p.allowTextOverflow?t.parent&&t.parent.children&&t.parent.lvl<_.curMaxLevel?e.opacity:0:t.parent&&t.parent.children&&t.parent.lvl<_.curMaxLevel&&O*t.dx-2*R>=this.width&&S*t.dy-2*R>=this.height?e.opacity:0}),O=E/e.dx,S=T/e.dy,b.domain([e.x,e.x+e.dx]),w.domain([e.y,e.y+e.dy]),h(u,f,e,s),h(l,l.select("text"),e,s),l.filter(function(t){return t.children&&t.lvl<_.curMaxLevel}).on("touch",null).on("tap",null).on("hold",null),d=l.exit().transition().duration(s).tween("groupTween",function(e){var i=o(e.parent||e,e.parent||e),n=t.interpolate(this.left,b(i.x+i.dx/2)),r=t.interpolate(this.top,w(i.y+i.dy/2)),s=t.interpolate(this.width,0),a=t.interpolate(this.height,0),h=t.interpolate(this.opacity,0),c=this;return function(t){c.left=n(t),c.top=r(t),c.width=s(t),c.height=a(t),c.opacity=h(t)}}).each(function(){this.remove()},"end"),m=d.select("text").each(function(t){t.sdx=0,t.sdy=0}).tween("textTween",a(e)),t.event&&t.event.stopPropagation()}function l(o,r,s,a,h,l,u,d,p,R){f=r,g=h,E=s,T=a,b=e().range([0,E]),w=e().range([0,T]),m=l,v=u,x=d,y=p;var M,I=i(R);_=g(),P=t.layout.treemap().round(!1).sort(_.sortBy).size([E,T]).sticky(!1).mode("squarify").value(function(t){return t.size}).children(function(t){return t.children}),N=f.append("group").each(function(){this.fontFamily="Times New Roman",this.fontSize=11}),M=P.nodes(_).filter(function(t){return n(t,I)<_.maxVisibleLevels}).sort(function(t,e){return t.depth===e.depth?e.value-t.value:t.depth-e.depth}),N.selectAll("group").data(M,function(t){return t.id}),O=E/R.dx,S=T/R.dy,b.domain([R.x,R.x+R.dx]),w.domain([R.y,R.y+R.dy]),c(R,0)}function u(t,e){E=t,T=e,b.range([0,E]),w.range([0,T])}function d(){N.remove()}var p,f,g,m,v,x,y,E,T,b,w,_,P,N,O,S,R=3,M=t.interpolate("#888","#fff");return p={init:l,update:c,resize:u,remove:d,enableRotate:!1,enableRotateDefault:!1,enableRootZoom:!0,fontSize:11,fontFamily:"Times New Roman",allowTextOverflow:!1}}}),define("scalejs.visualization-d3/sunburst",["knockout","d3"],function(t,e){var i=t.utils.unwrapObservable;return function(){function t(t){for(var e=[];t!==F;)e.push(t),t=t.parent;return e.push(t),e}function n(t,e){for(var i=0;e.indexOf(t)<0;)i+=1,t=t.parent;return i}function o(t){var e,i=1;return 0===t.indexOf("rgba")&&(e=t.substring(5,t.length-1).replace(/ /g,"").split(","),i=Number(e.pop()),t="rgb("+e.join(",")+")"),{color:t,opacity:i}}function r(t){return Math.max(0,Math.min(2*Math.PI,M(t.x)))}function s(t){return Math.max(0,Math.min(2*Math.PI,M(t.x+t.dx)))}function a(t){return Math.max(0,I(t.y))}function h(t){return Math.max(0,I(t.y+t.dy))}function c(t,e){var i,n=[];for(i=0;t>i;i+=1)n[i]=e;return n}function l(t,e){var i=0,n=t.levelsFr,o=t.fr||1,r=t.parentFr||1;return n.length<F.maxlvl+1&&(n=n.concat(c(F.maxlvl-n.length+1,o))),n=n.map(function(t,n){return n===e.lvl-1?i+=r:n>e.lvl-1&&n<=F.curMaxLevel?i+=t:i}).map(function(t,e,i){return t/i[i.length-1]*R}),n.unshift(0),n}function u(t){var e,i=[];for(e=0;e<t.length;e++)i.push(e/(t.length-1));return i}function d(t){var i=A&&A.levelsFr,n=i?l(A,t):[t.y?t.dy*R/2:0,R],o=i?u(n,t):[t.y,(F.curMaxLevel+1)/(F.maxlvl+1)];return function(){var i=e.interpolate(M.domain(),[t.x,t.x+t.dx]),r=e.interpolate(I.domain(),o),s=e.interpolate(I.range(),n);return function(t){M.domain(i(t)),I.domain(r(t)).range(s(t))}}}function p(t){return function(i){var n=e.interpolate(this.old.x,i.x),r=e.interpolate(this.old.y,i.y),s=e.interpolate(this.old.dx,i.dx),a=e.interpolate(this.old.dy,i.dy),h=e.interpolate(this.left,O/2),c=e.interpolate(this.top,S/2),l=o(i.color),u=e.interpolate(this.opacity,t*l.opacity);return function(t){this.old.x=n(t),this.old.y=r(t),this.old.dx=s(t),this.old.dy=a(t),this.left=h(t),this.top=c(t),this.opacity=u(t)}}}function f(){return function(t){var i=o(t.color),n=e.interpolate(this.fill,i.color),c=e.interpolate(this.opacity,i.opacity);return function(t){this.fill=n(t),this.opacity=c(t),this.innerRadius=a(this.old),this.outerRadius=h(this.old),this.startAngle=r(this.old),this.endAngle=s(this.old)}}}function g(t){return function(i){var n,c,l,u,d,p,f,g,m,v=o(i.fontColor),x=e.interpolate(this.fill,v.color),y=e.interpolate(this.opacity,v.opacity);return function(e){d=h(this.old),p=a(this.old),f=r(this.old),g=s(this.old),m=(g-f)*p,this.fill=x(e),n=M(this.old.x+this.old.dx/2),c=n-Math.PI/2,l=I(i.y)+2,u=180*n/Math.PI-90,this.left=l*Math.cos(c),this.top=l*Math.sin(c),t!==i?(u>90&&(u=(u+180)%360),this.originX=n>Math.PI?"right":"left",this.opacity=E.allowTextOverflow?y(e):d-p-4>=this.width&&(m-2>=this.height||t===i&&1>p)?y(e):0):(u-=90,this.originX="center",this.originY="top",this.opacity=E.allowTextOverflow?y(e):d-p-4>=this.height&&(m-2>=this.width||t===i&&1>p)?y(e):0),this.angle=A&&null!=A.enableRotatedText?A.enableRotatedText?u:0:u}}}function m(h,c){A=i(E.parameters),c=void 0!==c?c:1e3,F=b();var l,u,m,v,x,y,T,R,z,Y,V=t(h);l=j.sort(F.sortBy).nodes(F).filter(function(t){return n(t,V)<F.maxVisibleLevels}),u=D.selectAll("group").data(l,function(t){return t.id}),m=u.enter().append("group").each(function(t){this.left=O/2,this.top=S/2,this.opacity=0,this.old={x:t.x,y:t.y,dx:t.dx,dy:t.dy}}),y=m.append("arc").each(function(t){this.fill=t.color,this.outerRadius=this.innerRadius=a(t),this.endAngle=this.startAngle=(s(t)-r(t))/2,this.old=this.parent.old}).on("touch",w).on("tap",_).on("hold",P).on("release",N),z=m.append("text").each(function(t){F!==t?(this.originX=M(t.x+t.dx/2)>Math.PI?"right":"left",this.originY="center"):(this.originX="center",this.originY="top");var e=o(t.fontColor),i=180*M(t.x+t.dx/2)/Math.PI-90;this.fill=e.color,this.setText(t.name),t.bw=I(t.y+t.dy)-I(t.y),t.bh=(M(t.x+t.dx)-M(t.x))*I(t.y),F!==t?(i>90&&(i=(i+180)%360),this.opacity=E.allowTextOverflow?e.opacity:t.bw-4>=this.height&&(t.bh-2>=this.width||F===t&&I(t.y)<1)?e.opacity:0):(i-=90,this.opacity=E.allowTextOverflow?e.opacity:t.bw-4>=this.width&&(t.bh-2>=this.height||F===t&&I(t.y)<1)?e.opacity:0),this.angle=i,this.left=(Math.max(I(t.y),0)+2)*Math.cos(M(t.x+t.dx/2)-Math.PI/2),this.top=(Math.max(I(t.y),0)+2)*Math.sin(M(t.x+t.dx/2)-Math.PI/2),this.old=this.parent.old}),D.transition().duration(c).tween("zoomTween",d(h)),m.transition().duration(c).tween("groupTween",p(1)),y.transition().duration(c).tween("arcTween",f(h)),z.transition().duration(c).tween("textTween",g(h)),u.transition().duration(c).tween("groupTween",p(1)),x=u.select("arc").transition().duration(c).tween("arcTween",f(h)),R=u.select("text").transition().duration(c).tween("textTween",g(h)),v=u.exit().transition().duration(c).tween("groupTween",p(0)).each(function(){this.remove()},"end"),T=v.select("arc").tween("arcTween",f(h)),Y=v.select("text").tween("textTween",g(h)),e.event&&e.event.stopPropagation()}function v(i,o,r,s,a,h,c,l,u,d){T=o,b=a,O=r,S=s,R=Math.min(O,S)/2,M=e.scale.linear().range([0,2*Math.PI]),I=e.scale.linear().range([0,R]),w=h,_=c,P=l,N=u;var p,f=t(d);F=b(),j=e.layout.partition().sort(F.sortBy).value(function(t){return t.size}).children(function(t){return t.children}),z=T.append("group"),D=z.append("group").each(function(){this.fontFamily="Times New Roman",this.fontSize=11}),p=j.nodes(F).filter(function(t){return n(t,f)<F.maxVisibleLevels}),D.selectAll("group").data(p,function(t){return t.id}),M.domain([d.x,d.x+d.dx]),I.domain([d.y,(F.curMaxLevel+1)/(F.maxlvl+1)]).range([d.y?d.dy*R/2:0,R]),m(d,0)}function x(t,e){O=t,S=e,R=Math.min(O,S)/2,I.range([0,R])}function y(){void 0!==D&&(z.remove(),z=void 0,D=void 0)}var E,T,b,w,_,P,N,O,S,R,M,I,F,j,z,D,A;return E={init:v,update:m,resize:x,remove:y,enableRotate:!0,enableRotateDefault:!0,enableRootZoom:!1,fontSize:11,fontFamily:"Times New Roman",allowTextOverflow:!1}}}),define("scalejs.visualization-d3/visualization",["scalejs!core","knockout","d3","d3.colorbrewer","scalejs.canvas","scalejs.visualization-d3/treemap","scalejs.visualization-d3/sunburst"],function(t,e,i,n,o,r,s){function a(t){function e(e){var i="Calling "+e+" function of undefined visualization. Visualization ("+t+") doesn't exist!";return function(){console.error(i)}}return{init:e("init"),update:e("update"),resize:e("resize"),remove:e("remove")}}function h(r,s){function h(t){var e=F();if(t instanceof Array){for(var i=0;i<t.length;i+=1){if(void 0===e.childrenReference[t[i]])return;e=e.childrenReference[t[i]]}return e}}function g(){te.left=0,te.top=0,te.rotate=0,te.scale=1,z.select("group").transition().duration(1e3).tween("canvasTween",function(){var t=i.interpolate(this.left,0),e=i.interpolate(this.top,0),n=i.interpolate(this.angle,0),o=i.interpolate(this.scaleX,1),r=i.interpolate(this.scaleY,1),s=this;return function(i){s.left=t(i),s.top=e(i),s.angle=n(i),s.scaleX=o(i),s.scaleY=r(i)}})}function m(){J(void 0)}function v(t){for(var e=[],i=t;void 0!==i.parent;)e.unshift(i.index),i=i.parent;K(e)}function x(t){for(var e=[],i=t;void 0!==i.parent;)e.unshift(i.index),i=i.parent;J(e)}function y(t){var e,n=[],o=$;if(u(U)){for(M.enableRootZoom&&t===o&&(t=V),t!==o&&g(),$=e=t,V.curLevel=$.lvl,V.curMaxLevel=$.lvl+V.maxVisibleLevels-1;void 0!==e.parent;)n.unshift(e.index),e=e.parent;Z(n)}i.event&&i.event.stopPropagation()}function E(t,e,i,n){te.left=t,te.top=e,te.rotate=i,te.scale=n,z.select("group").attr("scaleX",te.scale).attr("scaleY",te.scale).attr("angle",te.rotate).attr("left",te.left).attr("top",te.top),z.pumpRender()}function T(){return M.enableRotate=void 0!==u(H)?u(H):M.enableRotateDefault,C.setRotateState(M.enableRotate),te}function b(t){return function(e,i,n,o){if(!M.enableRotate){e>0&&(e=0),i>0&&(i=0);var r=e+o*A,s=i+o*Y;A>r&&(e+=A-r),Y>s&&(i+=Y-s)}return 1>o?t(e,i,n,o):(te.left=e,te.top=i,te.rotate=n,te.scale=o),te}}function w(t,e,i,n){n=Math.max(ee,n),te.left=(1-n)/2*A,te.top=(1-n)/2*Y,te.rotate=0,te.scale=n}function _(t,e,i,n){te.left=0,te.top=0,te.rotate=0,te.scale=1,ee+(1-ee)/4>n&&y($.parent||$)}function P(){C=t.canvas.touch&&u(B)?t.canvas.touch({canvas:j,renderCallback:E,startCallback:T,stepCallback:b(w),endCallback:b(_)}):{setRotateState:function(){},remove:function(){}}}function N(){W.idPath=u(k.idPath)||"id",W.namePath=u(k.namePath)||W.idPath,W.childrenPath=u(k.childrenPath)||"children",W.areaPath=u(k.areaPath)||"area",W.colorPath=u(k.colorPath)||"color",W.colorPalette=u(k.colorPalette)||"PuBu",W.fontSize=u(k.fontSize)||11,W.fontFamily=u(k.fontFamily)||"Times New Roman",W.fontColor=u(k.fontColor)||"#000",W.colorPalette instanceof Array?1===W.colorPalette.length&&(W.colorPalette[1]=W.colorPalette[0]):W.colorPalette=n[W.colorPalette][3]}function O(t){for(var e=[],i=0;i<t.length;i+=1){var o=t[i];o instanceof Object?(e[i]={idPath:u(o.idPath)||W.idPath,namePath:u(o.namePath||o.idPath)||W.namePath,childrenPath:u(o.childrenPath)||W.childrenPath,areaPath:u(o.areaPath)||W.areaPath,colorPath:u(o.colorPath)||W.colorPath,fontSize:u(o.fontSize)||W.fontSize,fontFamily:u(o.fontFamily)||W.fontFamily,fontColor:u(o.fontColor)||W.fontColor,colorPalette:u(o.colorPalette)},e[i].colorPalette instanceof Array?1===e[i].colorPalette.length&&(e[i].colorPalette[1]=e[i].colorPalette[0]):e[i].colorPalette=null==e[i].colorPalette?W.colorPalette:n[e[i].colorPalette][3]):e[i]={childrenPath:o||W.childrenPath,idPath:W.idPath,namePath:W.namePath,areaPath:W.areaPath,colorPath:W.colorPath,colorPalette:W.colorPalette,fontSize:W.fontSize,fontFamily:W.fontFamily,fontColor:W.fontColor}}return e}function S(t,e,n,o){var r,s,a,h=e[n]||W,c={id:t[h.idPath]||"",name:t[h.namePath]||"",lvl:n,size:void 0!==t[h.areaPath]?t[h.areaPath]:1,colorSize:t[h.colorPath]||0,fontSize:h.fontSize,fontFamily:h.fontFamily,fontColor:h.fontColor};if(c.id===$.id&&($=c),!t[h.childrenPath])return o.value<n&&(o.value=n),c;c.children=[],c.childrenReference=[],s=t[h.childrenPath];for(var l=0;l<s.length;l+=1)r=S(s[l],e,n+1,o),r.parent=c,r.index=l,void 0===t[h.areaPath]&&(c.size+=r.size),void 0===t[h.colorPath]&&(c.colorSize+=r.colorSize),c.minSize=Math.min(c.minSize||r.size,r.size),c.maxSize=Math.max(c.maxSize||r.size+1,r.size),c.minColor=Math.min(c.minColor||r.colorSize,r.colorSize),c.maxColor=Math.max(c.maxColor||r.colorSize+1,r.colorSize),c.children[l]=c.childrenReference[l]=r;Q.range(e.length<=n+1?W.colorPalette:e[n+1].colorPalette),a=(c.maxColor-c.minColor)/Math.max(Q.range().length-1,1),Q.domain(i.range(c.minColor,c.maxColor+a,a));for(var l=0;l<s.length;l+=1)c.children[l].color=Q(c.children[l].colorSize);return c}function R(t){M=null!=p[t]?p[t]():a(t),te.left=0,te.top=0,te.rotate=0,te.scale=1,M.allowTextOverflow=u(q),M.parameters=l(function(){return u(k[t])}),M.init(k,z,A,Y,F,v,y,x,m,$,r)}var M,I,F,j,z,D,A,Y,V,C,X,k=s(),L=null==k.triggerTime||10,H=k.enableRotate,U=k.enableZoom||!1,B=k.enableTouch||!1,q=k.allowTextOverflow||!1,G=d(k.visualization)?k.visualization:c(k.visualization),W={},Z=d(k.zoomedItemPath)?k.zoomedItemPath:c(k.zoomedItemPath),K=d(k.selectedItemPath)?k.selectedItemPath:c(k.selectedItemPath),J=d(k.heldItemPath)?k.heldItemPath:c(k.heldItemPath),Q=i.scale.linear(),$={id:null},te={left:0,top:0,rotate:0,scale:1},ee=.8;Z.subscribe(function(t){var e=h(t);e||(Z([]),e=F()),e&&($=e,V.curLevel=$.lvl,V.curMaxLevel=$.lvl+V.maxVisibleLevels-1,M.update($))}),K.subscribe(function(t){h(t)||K(void 0)}),D=window.getComputedStyle(r),A=parseInt(D.width,10),A=A>=1?A:1,Y=parseInt(D.height,10),Y=Y>=1?Y:1,j=i.select(r).style("overflow","hidden").append("canvas").attr("width",A).attr("height",Y).node(),P(),d(B)&&B.subscribe(function(){C.remove(),P()}),z=o.select(j).ease(i.ease("cubic-in-out")),F=e.computed(function(){var t,e,n={value:0},o=u(k.sortBy)||"unordered",r=u(k.maxVisibleLevels||2),s=u(k.data)||{name:"Empty"},a=u(k.levels)||[{}];return N(),e=O(a),V=S(s,e,0,n,0),null==$.id&&($=V),V.curLevel=$.lvl,V.curMaxLevel=$.lvl+r-1,V.maxlvl=n.value,V.maxVisibleLevels=r,V.levels=e,V.index=0,V.sortBy=o instanceof Function?o:f[o]?f[o]:o.unordered,Q.range(e[0].colorPalette),t=2/Math.max(Q.range().length-1,1),Q.domain(i.range(V.colorSize-t/2,V.colorSize+t/2,t)),V.color=Q(V.colorSize),I=u(k[G.peek()]),V}).extend({throttle:L}),R(G()),d(q)&&q.subscribe(function(){M.allowTextOverflow=u(q),M.update($)}),G.subscribe(function(t){M.remove(),R(t)}),F.subscribe(function(){M.update($)}),t.layout&&(X=t.layout.onLayoutDone(function(){var t=A,e=Y;D=window.getComputedStyle(r),A=parseInt(D.width,10),A=A>=1?A:1,Y=parseInt(D.height,10),Y=Y>=1?Y:1,(A!==t||Y!==e)&&(z.attr("width",A),z.attr("height",Y),M.resize(A,Y),g(),M.update($))}),e.utils.domNodeDisposal.addDisposeCallback(r,function(){X(),X=void 0}))}var c=e.observable,l=e.computed,u=e.utils.unwrapObservable,d=e.isObservable,p={treemap:r,sunburst:s},f={unordered:function(t,e){return t.index-e.index},ascendingSize:function(t,e){return t.size-e.size},descendingSize:function(t,e){return e.size-t.size}};return{init:h}}),define("scalejs.visualization-d3",["scalejs!core","knockout","scalejs.visualization-d3/visualization"],function(t,e,i){return e.bindingHandlers.d3?(console.error("visualization-d3 is already setup"),!1):(e.bindingHandlers.d3=i,e.virtualElements.allowedBindings.d3=!0,void t.registerExtension({d3:i}))});