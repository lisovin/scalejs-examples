/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

define("text",["module"],function(e){var t,a,n,r,i,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,d=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,l=c&&location.protocol&&location.protocol.replace(/\:/,""),u=c&&location.hostname,f=c&&(location.port||void 0),p={},b=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(d);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:b.createXhr||function(){var e,t,a;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){a=s[t];try{e=new ActiveXObject(a)}catch(n){}if(e){s=[a];break}}return e},parseName:function(e){var t,a,n,r=!1,i=e.indexOf("."),s=0===e.indexOf("./")||0===e.indexOf("../");return-1!==i&&(!s||i>1)?(t=e.substring(0,i),a=e.substring(i+1,e.length)):t=e,n=a||t,i=n.indexOf("!"),-1!==i&&(r="strip"===n.substring(i+1),n=n.substring(0,i),a?a=n:t=n),{moduleName:t,ext:a,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,a,n,r){var i,s,o,d=t.xdRegExp.exec(e);return d?(i=d[2],s=d[3],s=s.split(":"),o=s[1],s=s[0],!(i&&i!==a||s&&s.toLowerCase()!==n.toLowerCase()||(o||s)&&o!==r)):!0},finishLoad:function(e,a,n,r){n=a?t.strip(n):n,b.isBuild&&(p[e]=n),r(n)},load:function(e,a,n,r){if(r.isBuild&&!r.inlineText)return n(),void 0;b.isBuild=r.isBuild;var i=t.parseName(e),s=i.moduleName+(i.ext?"."+i.ext:""),o=a.toUrl(s),d=b.useXhr||t.useXhr;return 0===o.indexOf("empty:")?(n(),void 0):(!c||d(o,l,u,f)?t.get(o,function(a){t.finishLoad(e,i.strip,a,n)},function(e){n.error&&n.error(e)}):a([s],function(e){t.finishLoad(i.moduleName+"."+i.ext,i.strip,e,n)}),void 0)},write:function(e,a,n){if(p.hasOwnProperty(a)){var r=t.jsEscape(p[a]);n.asModule(e+"!"+a,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,a,n,r,i){var s=t.parseName(a),o=s.ext?"."+s.ext:"",d=s.moduleName+o,c=n.toUrl(s.moduleName+o)+".js";t.load(d,n,function(){var a=function(e){return r(c,e)};a.asModule=function(e,t){return r.asModule(e,c,t)},t.write(e,d,a,i)},i)}},"node"===b.env||!b.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(a=require.nodeRequire("fs"),t.get=function(e,t,n){try{var r=a.readFileSync(e,"utf8");0===r.indexOf("ï»¿")&&(r=r.substring(1)),t(r)}catch(i){n(i)}}):"xhr"===b.env||!b.env&&t.createXhr()?t.get=function(e,a,n,r){var i,s=t.createXhr();if(s.open("GET",e,!0),r)for(i in r)r.hasOwnProperty(i)&&s.setRequestHeader(i.toLowerCase(),r[i]);b.onXhr&&b.onXhr(s,e),s.onreadystatechange=function(){var t,r;4===s.readyState&&(t=s.status,t>399&&600>t?(r=new Error(e+" HTTP status: "+t),r.xhr=s,n(r)):a(s.responseText),b.onXhrComplete&&b.onXhrComplete(s,e))},s.send(null)}:"rhino"===b.env||!b.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var a,n,r="utf-8",i=new java.io.File(e),s=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(i),r)),d="";try{for(a=new java.lang.StringBuffer,n=o.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&a.append(n);null!==(n=o.readLine());)a.append(s),a.append(n);d=String(a.toString())}finally{o.close()}t(d)}:("xpconnect"===b.env||!b.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,r=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),i="@mozilla.org/windows-registry-key;1"in n,t.get=function(e,t){var a,s,o,d={};i&&(e=e.replace(/\//g,"\\")),o=new FileUtils.File(e);try{a=n["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),a.init(o,1,0,!1),s=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),s.init(a,"utf-8",a.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(a.available(),d),s.close(),a.close(),t(d.value)}catch(c){throw new Error((o&&o.path||"")+": "+c)}}),t}),define("text!scalejs.tabs-jqueryui/tabs.html",[],function(){return'<div id="tabs_template">\r\n    <div class="tabs" style="height:100%">\r\n        <div data-class="tabs-header-right" style="position:absolute;right:0px;"></div>\r\n            <ul class="tab-headers" data-class="tabs-sortable"></ul>\r\n                <!-- ko class: tabs-items-source -->\r\n                <div data-class="tabs-content-container">\r\n                        <!-- ko class:tabs-content-template -->\r\n                        <!-- /ko -->\r\n                </div>\r\n                <!-- /ko -->\r\n    </div>\r\n    <div class="tabs-more tabs-menu">\r\n    <!-- ko foreach: itemsSource -->\r\n        <div class="tabs-menu-item">\r\n            <span data-class="tabs-more-item"></span>\r\n            <div class="iconClose" data-class="tab-close"></div>\r\n        </div>\r\n    <!-- /ko -->       \r\n    </div> \r\n        <div class="tabs-add tabs-menu">\r\n            <!-- ko foreach: menuItems -->\r\n                <div class="tabs-menu-item" data-bind="text: header, click: addTab"></div>\r\n            <!-- /ko -->\r\n    </div>\r\n</div>\r\n\r\n <div id="tabs_content_default_template">\r\n         <p data-bind="text: $data"></p>\r\n</div>\r\n \r\n <div id="tabs_more_item_template">\r\n    <li class="tabs-menu-item">\r\n     <div class="tabs-header-text" data-class="tabs-header-text"></div>\r\n     <div class="iconClose" data-class="tab-close"></div></li>\r\n</div>\r\n\r\n <div id="tabs_header_item_template">\r\n    <li>\r\n        <a data-class="tabs-header">\r\n            <div class="tabs-header-text" data-class="tabs-header-text"></div>\r\n        </a>\r\n        <div class="iconClose" data-class="tab-more-close"></div>\r\n        <div class="iconMore" data-class="tab-more"></div>\r\n        <!--<div class="iconMax" data-class="tab-max"></div>-->\r\n    </li>\r\n</div>\r\n\r\n <div id="tabs_menu_temp_template">\r\n    <div class="tabs-menu">\r\n        <!-- ko foreach: menuItems -->\r\n            <div class="tabs-menu-item" data-bind="text: header, click: addTab"></div>\r\n        <!-- /ko -->\r\n    </div> \r\n</div>'}),define("scalejs.tabs-jqueryui/tabsBindings",{"tabs-header":function(){return{click:function(e,t){t.preventDefault()}}},"tabs-header-text":function(){return{text:this.header}},"tabs-items-source":function(){return{foreach:this.itemsSource}},"tabs-header-edit":function(){return{value:this.header,valueUpdate:"afterkeydown"}},"tabs-content-template":function(e){var t=this.contentTemplate||e.$parent.contentTemplate||"tabs_content_default_template";return{template:{name:t,data:this.content}}},"tabs-header-right":function(){return this.headerTemplate?{template:{name:this.headerTemplate,data:this.content}}:{}},"tab-more-close":function(e){var t=e.$parent.itemsSource,a=e.$parent.refreshTabs;return{click:function(){t.remove(e.$data),a()},visible:!e.$parent.more()}},"tab-close":function(e){var t=e.$parent.itemsSource,a=e.$parent.refreshTabs;return{click:function(){t.remove(e.$data),a()}}},"tab-max":function(){return{click:function(e){console.log("maximixing",e)}}},"tabs-sortable":function(){return{sortable:{template:"tabs_header_item_template",data:this.itemsSource,options:this.sortOptions,afterMove:this.afterMove}}},"tab-more":function(e){return{visible:e.$parent.more,click:e.$parent.openMore}},"tabs-more-item":function(e){return{style:{color:e.$parent.active()===e.$index()?"red":"white"},text:this.header}}}),define("scalejs.tabs-jqueryui",["scalejs!core","knockout","jQuery","text!./scalejs.tabs-jqueryui/tabs.html","./scalejs.tabs-jqueryui/tabsBindings","scalejs.mvvm","bPopup","knockout-sortable"],function(e,t,a,n,r){function i(e,n){return function(){function r(){d=a(t.virtualElements.firstChild(n)).parent(),h.add=a(a(d).find(".tabs-add")).hide(),h.more=a(a(d).find(".tabs-more")).hide(),m=a(a(d).find(".tabs")).tabs(),a.widget("ui.tabs",a.ui.tabs,{options:{keyboard:!0},_tabKeydown:function(){return this.options.keyboard?(this._super("_tabKeydown"),void 0):!1}}),m.delegate("a.ui-tabs-anchor","dblclick",function(){var e,n=t.dataFor(this).header,r=this;c(n)&&(a(r).find("[data-class='tabs-header-text']").replaceWith("<input data-class='tabs-header-edit' />"),e=a(r).find("input"),t.applyBindings(t.dataFor(this),e.get(0)),e.focus(),e.bind("keyup",function(n){var i=n.keyCode||n.which;13==i&&(e.replaceWith("<div class='tabs-header-text' data-class='tabs-header-text'></div>"),t.applyBindings(t.dataFor(r),a(r).find("[data-class='tabs-header-text']").get(0)))}),e.bind("blur",function(){e.replaceWith("<div class='tabs-header-text' data-class='tabs-header-text'></div>"),t.applyBindings(t.dataFor(r),a(r).find("[data-class='tabs-header-text']").get(0))}))}),a(window).resize(s)}function i(e){m.find('a[data-class="tabs-header"]').each(function(e,t){a(t).attr("href","#tabs-"+e)}),m.find('div[data-class="tabs-content-container"]').each(function(e,t){a(t).attr("id","tabs-"+e)}),m.tabs("destroy"),m=a(a(d).find(".tabs")).tabs(),setTimeout(function(){m.find(".tab-headers").sortable("refresh")}),m.tabs("option","active",e||m.tabs("option","active")),v.active(m.tabs("option","active")),m.find(".ui-tabs-panel").each(function(){var e=m.height(),t=m.find(".tab-headers").height();a(this).height(e-t)}),h.more.find(".tabs-menu-item").each(function(e,t){a(t).unbind().click(function(){h.more.bPopup({opacity:0}).close(),i(e)})}),o(),s()}function s(){var e=m.outerWidth(),t=m.find("ul.tab-headers"),n=t.find("li").show(),r=n.get().reduce(function(e,t){return e+=a(t).outerWidth()},0)+20;v.more(!1),r>e&&(n.hide(),v.more(!0),t.find(".ui-state-active").show()),o()}function o(){var e;m.find("li.add").remove(),$headers=m.find("ul.tab-headers"),$headers.append('<li class="unsortable add"><a href="#tabs-add">+</a></li>'),e=m.find('[href="#tabs-add"]'),e.unbind().click(function(t){t.preventDefault(),h.add.bPopup({follow:[!1,!1],position:[e.offset().left+m.find("li.add").width(),e.offset().top],opacity:0,speed:0})})}var d,b,m,v=e(),h={};return v.sortOptions={items:"li:not(.unsortable)",axis:"x",start:function(){},stop:function(e){b=e.targetIndex}},v.menuItems=l(u(f(v.defaultItems)).select(function(e){var t=p(e,{addTab:function(){h.add.bPopup({opacity:0}).close(),v.itemsSource.push(e.create()),i(v.itemsSource().length-1)}});return t}).toArray()),v.afterMove=function(){console.log("sort complete"),i()},v.refreshTabs=i,v.more=t.observable(!1),v.active=t.observable(1),v.openMore=function(){var e=a(m.find("li").get(1));h.more.bPopup({follow:[!1,!1],position:[e.offset().left+10,e.offset().top+e.outerHeight()+10],opacity:0,speed:0})},{data:v,name:"tabs_template",afterRender:function(){r(),i()}}}}function s(e,a,n,r,s){return t.bindingHandlers.template.update(e,i(a,e),n,r,s),{controlsDescendantBindings:!0}}var o=e.mvvm.registerTemplates,d=e.mvvm.registerBindings,c=t.isObservable,l=t.observableArray,u=e.linq.enumerable.from,f=t.unwrap,p=e.object.merge;o(n),d(r),t.bindingHandlers.tabs={init:s},t.virtualElements.allowedBindings.tabs=!0,t.virtualElements.allowedBindings.sortable=!0});