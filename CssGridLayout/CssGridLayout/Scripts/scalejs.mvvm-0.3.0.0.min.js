//knockout-classBindingProvider v0.4.0 | (c) 2012 Ryan Niemeyer | http://www.opensource.org/licenses/mit-license

define("scalejs.mvvm/classBindingProvider",["knockout"],function(e){return function(n){function t(e){var n,t;return d[e]?d[e]:(n=e.split("."),t=n.reduce(function(e,n){return e[n]},d))}function i(n){e.utils.extend(d,n)}function r(e){var t,i;return 1===e.nodeType?t=e.getAttribute(s):8===e.nodeType&&(i=(e.nodeValue||e.text||"").toString(),t=i.indexOf(l)>-1),!t&&n.fallback&&(t=c.nodeHasBindings(e)),t}function a(t,i){var r,a,d,u,f,g={},p="";1===t.nodeType?p=t.getAttribute(s):8===t.nodeType&&(u=(t.nodeValue||t.text||"").toString(),f=u.indexOf(l),f>-1&&(p=u.substring(f+l.length))),p?(p=p.replace(/^(\s|\u00A0)+|(\s|\u00A0)+$/g,"").replace(/(\s|\u00A0){2,}/g," ").split(" "),p.forEach(function(n){r=o(n),r&&(a="function"==typeof r?r.call(i.$data,i,p):r,e.utils.extend(g,a))})):n.fallback&&(g=c.getBindings(t,i));for(d in g)g.hasOwnProperty(d)&&"_ko_property_writers"!==d&&"valueUpdate"!==d&&!e.bindingHandlers[d]&&n.log&&(a?n.log('Unknown binding handler "'+d+'" found in',t,'defined in data-class "'+p+'" as',a,"Make sure that binding handler's name spelled correctly and that it's properly registered. The binding will be ignored."):n.log('Unknown binding handler "'+d+'" in',t,"Make sure that it's name spelled correctly and that it's properly registered. The binding will be ignored."));return g}var o,s,l,c=new e.bindingProvider,d={};return n=n||{},s=n.attribute||"data-class",l="ko "+(n.virtualAttribute||"class")+":",o=n.bindingRouter||t,{registerBindings:i,getBindings:a,nodeHasBindings:r,bindingRouter:o}}}),define("scalejs.mvvm/htmlTemplateSource",["knockout","scalejs!core"],function(e,n){function t(e){var n=document.createElement("div");n.innerHTML=e,r(n.childNodes).forEach(function(e){1===e.nodeType&&a(e,"id")&&(s[e.id]=e.innerHTML)})}function i(e){function n(n,t){return a(s.data,e)||(s.data[e]={}),1===arguments.length?s.data[e][n]:(s.data[e][n]=t,void 0)}function t(n){if(0===arguments.length)return s[e];throw new Error('An attempt to override template "'+e+'" with content "'+n+'" '+"Template overriding is not supported.")}return{data:n,text:t}}var r=n.array.toArray,a=n.object.has,o=new e.nativeTemplateEngine,s={data:{}};return o.makeTemplateSource=i,e.setTemplateEngine(o),{registerTemplates:t}}),define("scalejs.mvvm/selectableArray",["knockout","scalejs!core"],function(e,n){var t=e.isObservable,i=e.utils.unwrapObservable,r=e.observable,a=e.computed,o=n.object.has,s=n.array;return function(e,n){function l(e){if(!t(e.isSelected)||o(n.isSelectedPath)&&"isSelected"!==n.isSelectedPath){if(t(e.isSelected))throw new Error('item has observable `isSelected` property but `isSelectedPath` specified as "'+n.isSelectedPath+'". `selectable` uses `isSelected` property of an item '+"to determine whether it's selected. Either don't specify `isSelectedPath` or "+"rename `isSelected` property to something else.");if(e.hasOwnProperty("isSelected"))throw new Error("item has non-observable `isSelected` property. `selectable` uses `isSelected` property of an item to determine whether it's selected. Either make `isSelected` observable or rename it.");if(e.isSelected=r(),o(n.isSelectedPath)&&"isSelected"!==n.isSelectedPath&&!t(e[n.isSelectedPath]))throw new Error("item's property \""+n.isSelectedPath+'" specified by `isSelectedPath` '+" isn't observable. Either make it observable or specify different property in "+" `isSelectedPath`");o(n.isSelectedPath)&&(e.isSelected=e[n.isSelectedPath]),e.isSelected.subscribe(function(n){n?d(e):d()===e&&d(void 0)})}}n=n||{};var c,d=n.selectedItem||r(),u=n.selectionPolicy||"single";return t(e)?c=a(function(){var n=i(e);return n.forEach(l),s.copy(n)}):(e.forEach(l),c=s.copy(e)),d.subscribe(function(e){i(c).forEach(function(n){n.isSelected(n===e)}),"deselect"===u&&e&&setTimeout(function(){d(void 0)},0)}),c.selectedItem=d,c}}),define("scalejs.mvvm/ko.utils",["scalejs!core","knockout"],function(e,n){function t(t,i){return e.array.toArray(t).map(function(e){var t=e.cloneNode(!0);return i?n.cleanNode(t):t})}return{cloneNodes:t}}),define("scalejs.mvvm/mvvm",["knockout","knockout.mapping","scalejs!core","./classBindingProvider","./htmlTemplateSource","./selectableArray","./ko.utils","module"],function(e,n,t,i,r,a,o,s){function l(n){return e.observable(n)}function c(n){return e.observableArray(n)}function d(n){return e.computed(n)}function u(e){return n.toJSON(e)}function f(e){return JSON.parse(u(e))}function g(e){w.registerBindings(e)}function p(e,t,i){var r=Object.keys(i).reduce(function(e,n){return k(e,{k:n,create:function(e){return i[n](e.data)}})},{});return n.fromJS(e,r,t)}function m(){S(arguments).forEach(r.registerTemplates)}function b(e,n){var t={};return t[e]=n,t}function v(e,n){return b("template",{name:e,data:n})}function h(e,n){return{dataClass:e,viewmodel:n}}function y(){var n=document.getElementsByTagName("body")[0];n.innerHTML="<!-- ko class: scalejs-shell --><!-- /ko -->",g({"scalejs-shell":function(e){return{render:e.$data.root}}}),e.applyBindings({root:T})}var k=t.object.merge,S=t.array.toArray,w=i({log:s.config().logWarnings?t.log.warn:void 0,fallback:!0}),T=e.observable();return e.bindingProvider.instance=w,{core:{mvvm:{toJson:u,registerBindings:g,registerTemplates:m,dataClass:h,template:v,dataBinding:b,selectableArray:a,ko:{utils:o}}},sandbox:{mvvm:{observable:l,observableArray:c,computed:d,registerBindings:g,registerTemplates:m,toJson:u,toViewModel:p,toObject:f,dataClass:h,template:v,dataBinding:b,selectableArray:a,root:T}},init:y}}),define("scalejs.bindings/change",["knockout","scalejs!core"],function(e,n){function t(n,t,a,o){function s(e,t){return function(i){i!==t&&(t=i,e.call(o,i,n))}}function l(t,i){e.computed({read:function(){var e=f(o[t]);i(e)},disposeWhenNodeIsRemoved:n})}if(r(o)){var c,d,u,f=e.utils.unwrapObservable,g=t(),p=f(g);for(c in p)p.hasOwnProperty(c)&&(d=p[c],i(d.initial,"function")&&d.initial.apply(o,[f(o[c]),n]),i(d.update,"function")&&(u=s(d.update,f(o[c]))),i(d,"function")&&(u=s(d,f(o[c]))),u&&l(c,u))}}var i=n.type.is,r=n.object.has;return{init:t}}),define("scalejs.bindings/render",["scalejs!core","knockout","scalejs.functional"],function(e,n){function t(){return{controlsDescendantBindings:!0}}function i(e,t,i,f,g){var p,m,b,v,h,y=c(t());if(y){if(s(y.dataClass,"string")){if(b=n.bindingProvider.instance.bindingRouter(y.dataClass),!b)throw new Error("Don't know how to render binding \""+y.dataClass+'" - no such binding registered. '+"Either register the bindng or correct its name.");b&&(v=s(b,"function")?b.call(y.viewmodel||f,g):b)}else v=s(y,"function")?y.call(f,g):y;return l(a)&&l(a.transitions,"outTransitions")?(m=d.apply(null,a.transitions.outTransitions.map(function(e){return u(e)})),o={getElement:function(){return r}},m.call(o,function(){h=n.applyBindingsToNode(e,v,f)})):h=n.applyBindingsToNode(e,v,f),l(v,"transitions")?(l(v.transitions,"inTransitions")&&(p=d.apply(null,v.transitions.inTransitions.map(function(e){return u(e)})),o={getElement:function(){return e}},setTimeout(function(){p.call(o)},0)),a=v,r=e):(a=void 0,r=void 0),s(v,"afterRender","function")&&v.afterRender(e),s(y,"afterRender","function")&&y.afterRender(e),h}}var r,a,o,s=e.type.is,l=e.object.has,c=n.utils.unwrapObservable,d=e.functional.builders.complete,u=e.functional.builder.$DO;return{init:t,update:i}}),define("scalejs.mvvm",["scalejs!core","knockout","scalejs.mvvm/mvvm","./scalejs.bindings/change","./scalejs.bindings/render"],function(e,n,t,i,r){n.bindingHandlers.change=i,n.bindingHandlers.render=r,n.virtualElements.allowedBindings.change=!0,n.virtualElements.allowedBindings.render=!0,n.virtualElements.allowedBindings.transitionable=!0,t.init(),e.registerExtension(t)});