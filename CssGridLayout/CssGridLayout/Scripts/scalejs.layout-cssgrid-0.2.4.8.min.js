define("scalejs.layout-cssgrid/utils.base",[],function(){function e(e){return e!==undefined}function t(e,t){var n=!1,r=typeof t,i=typeof e;try{n=e instanceof t}catch(s){n=r==="string"&&i===t}return n}function n(e){return function(){return e.apply(null,arguments)}}function r(e,t,n){if(e===undefined||e===null)return[];var r=[],i,s;for(i=e.length;i--;r[i]=e[i]);return s=Array.prototype.slice.call(r,t,n),s}return String.prototype.contains=function(e){return this.indexOf(e)!==-1},{is:t,defined:e,toArray:r,createBoundedWrapper:n}}),define("scalejs.layout-cssgrid/utils.sheetLoader",["./utils.base","cssParser","domReady"],function(e,t){function r(e,n,i){if(n.hasOwnProperty(e))return;n[e]=null,require(["text!"+e],function(s){var o=t.parse(s);n[e]=o,(o.imports||[]).forEach(function(e){r(e["import"],n,i)}),i()})}function i(e){var t={};n(document.styleSheets).forEach(function(n){n.href&&r(n.href,t,function(){var n;for(n in t)if(t.hasOwnProperty(n)&&t[n]===null)return;e(t)})})}var n=e.toArray;return{loadAllStyleSheets:i}}),define("scalejs.layout-cssgrid/consts",[],function(){return{GRIDLAYOUT:"css-grid-layout",STRING:"string",PROPERTY:"property",MOZ:"-moz-",MS:"-ms-",OPERA:"-o-",WEBKIT:"-webkit-",SPACE:" ",PERIOD:".",COLON:":",SEMICOL:";",OPEN_CURLY:"{",CLOSE_CURLY:"}",HYPHEN:"-",EMPTY:"",AUTO:"auto",NONE:"none",DISPLAY:"display",POSITION:"position",RELATIVE:"relative",STATIC:"static",ABSOLUTE:"absolute",WIDTH:"width",HEIGHT:"height",PADDING:"padding",MARGIN:"margin",BORDER:"border",STYLE:"-style",TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right",MIN:"min-",MAX:"max-",PX:"px",EM:"em",PERCENT:"%",REM:"rem",FR:"fr",CONTENTBOX:"content-box",PADDINGBOX:"padding-box",STRETCH:"stretch",GRID:"grid",INLINEGRID:"inline-grid",GRIDCOLUMNS:"grid-columns",GRIDCOLUMN:"grid-column",GRIDCOLUMNSPAN:"grid-column-span",GRIDCOLUMNALIGN:"grid-column-align",GRIDROWS:"grid-rows",GRIDROW:"grid-row",GRIDROWSPAN:"grid-row-span",GRIDROWALIGN:"grid-row-align",BOXSIZING:"box-sizing",BLOCKPROGRESSION:"block-progression",precision:0,agentTruncatesLayoutLengths:!0,regexSpaces:/\s+/}}),define("scalejs.layout-cssgrid/enums",["./consts"],function(e){var t=e.EMPTY,n=e.STATIC,r={minWidth:{},maxWidth:{},minHeight:{},maxHeight:{},shrinkToFit:{}},i={auto:{keyword:e.AUTO},minContent:{keyword:"min-content"},maxContent:{keyword:"max-content"},fitContent:{keyword:"fit-content"},minmax:{keyword:"minmax"},parse:function(e){switch(e){case i.auto.keyword:return i.auto;case i.minContent.keyword:return i.minContent;case i.maxContent.keyword:return i.maxContent;case i.fitContent.keyword:return i.fitContent;case i.minmax.keyword:return i.minmax;default:throw new Error("unknown grid track string: "+e)}}},s={stretch:{keyword:e.STRETCH},start:{keyword:"start"},end:{keyword:"end"},center:{keyword:"center"},parse:function(e){switch(e){case s.start.keyword:return s.start;case s.end.keyword:return s.end;case s.center.keyword:return s.center;case s.stretch.keyword:case null:case t:return s.stretch;default:throw new Error("unknown grid align string: "+e)}}},o={"static":{keyword:e.STATIC},relative:{keyword:e.RELATIVE},absolute:{keyword:e.ABSOLUTE},fixed:{keyword:"fixed"},parse:function(e){switch(e){case o.relative.keyword:return o.relative;case o.absolute.keyword:return o.absolute;case o.fixed.keyword:return o.fixed;case o[n].keyword:case null:case t:return o[n];default:throw new Error("unknown position string: "+e)}}},u={tb:{keyword:"tb"},bt:{keyword:"bt"},lr:{keyword:"lr"},rl:{keyword:"rl"},parse:function(e){switch(e){case u.tb.keyword:case null:case t:return u.tb;case u.bt.keyword:return u.bt;case u.lr.keyword:return u.lr;case u.rl.keyword:return u.rl;default:throw new Error("unknown block-progression string: "+e)}}},a={thin:0,medium:0,thick:0},f={valueAndUnit:{},keyword:{}};return{calculatorOperation:r,gridTrackValue:i,gridAlign:s,position:o,blockProgression:u,borderWidths:a,sizingType:f}}),define("scalejs.layout-cssgrid/objects",["./enums"],function(e){function t(){return{number:null,size:null,sizingType:null,items:[],measure:null,minMeasure:null,maxMeasure:null,contentSizedTrack:!1,implicit:!1}}function n(){return{firstNumber:null,span:null,size:e.gridTrackValue.auto,sizingType:e.sizingType.keyword,items:[],measure:null}}function r(){return{width:null,height:null}}function i(){return{value:null,unit:null}}function s(){return{itemElement:null,styles:null,position:null,column:1,columnSpan:1,columnAlign:e.gridAlign.stretch,row:1,rowSpan:1,rowAlign:e.gridAlign.stretch,usedWidthMeasure:null,maxWidthMeasure:null,maxHeightMeasure:null,shrinkToFitSize:null,verified:{columnBreadth:!1,rowBreadth:!1,columnPosition:!1,rowPosition:!1}}}return{track:t,implicitTrackRange:n,item:s,widthAndHeight:r,cssValueAndUnit:i}}),define("scalejs.layout-cssgrid/utils.css",["./consts","./utils.base"],function(e,t){function m(e){return c(e,i)?e.toLowerCase():e}function g(e){var t=/(-[a-z])/g,s=function(e){return e.toUpperCase().replace(n,r)};return c(e,i)?m(e).replace(t,s):e}function y(){var e=(new Date).getTime();return e+=Math.floor(Math.random()*e),s+n+e}function b(e){return new RegExp(e)}function w(e){return b("(\\s|^)"+e+"(\\s|$)")}function E(e,t,n){return n=n||w(t),e.className.match(n)}function S(e,t,n){n=n||w(t),E(e,t,n)||(e.className+=o+t)}function x(e,t){var n;for(n in t)if(t[n]===e)return!0;return!1}function T(e,t){var n=p.cloneNode(!0);return e=e||u,n.setAttribute(a,e),t=t||"temp-"+Math.round(Math.random()*2+1),n.setAttribute("id",t),h.appendChild(n),n}function N(e,t){var r,i;t=t?"-"+t:"",e=e||u,r=s+n+e+t,i=document.getElementById(r);if(i)while(i.childNodes.length>0)i.removeChild(i.childNodes[0])}function C(e,t,r){t=t||u,r=r?"-"+r:"";var i=s+n+t+r,o;return x(t+r,d)?o=document.getElementById(i):(o=T(t,i),d.push(t+r)),o!==null&&v(o,e),o}function k(e,t){var n=window.getComputedStyle;return e.currentStyle?e.currentStyle[g(t)]:n?n(e,null).getPropertyValue(t):!1}var n=e.HYPHEN,r=e.EMPTY,i=e.STRING,s=e.GRIDLAYOUT,o=e.SPACE,u="all",a="media",f=e.TYPE,l=t.defined,c=t.is,h=document.getElementsByTagName("head")[0],p=document.createElement("style"),d=[],v;return p.setAttribute(f,"text/css"),l(p.styleSheet)?v=function(e,t){e.styleSheet.cssText+=t}:v=function(e,t){e.appendChild(document.createTextNode(t))},{makeUniqueClass:y,getCssValue:k,addClass:S,embedCss:C,clearEmbeddedCss:N}}),define("scalejs.layout-cssgrid/utils",["./utils.base","./utils.css"],function(e,t){return{is:e.is,defined:e.defined,createBoundedWrapper:e.createBoundedWrapper,makeUniqueClass:t.makeUniqueClass,getCssValue:t.getCssValue,addClass:t.addClass,embedCss:t.embedCss,clearEmbeddedCss:t.clearEmbeddedCss}}),define("scalejs.layout-cssgrid/layoutMeasure",["./consts","./enums","./utils"],function(e,t,n){function b(e){function n(){return t}function i(){return t/Math.pow(10,r)}function s(){var e=Math.abs,n=Math.pow,i=e(t%n(10,r)),s;return i>=5*n(10,r-1)?s=n(10,r)-i:s=-i,t<0&&(s=-s),b(t+s)}function o(e){if(typeof e.getRawMeasure!="function")throw new Error("LayoutMeasure.add only accepts layout measures");return b(t+e.getRawMeasure())}function u(e){if(typeof e.getRawMeasure!="function")throw new Error("LayoutMeasure.subtract only accepts layout measures");return b(t-e.getRawMeasure())}function a(e){if(typeof e!="number")throw new Error("LayoutMeasure.multiply only accepts numbers");return b(Math.floor(t*e))}function f(e){if(typeof e!="number")throw new Error("LayoutMeasure.divide only accepts number");return b(Math.floor(t/e))}function l(e){if(typeof e.getRawMeasure!="function")throw new Error("LayoutMeasure.equals only accepts layout measures");return t===e.getRawMeasure()}var t;if(e%1!==0)throw new Error("LayoutMeasures must be integers, measure was "+typeof e+"("+e+")");return t=e,{getRawMeasure:n,getPixelValue:i,getMeasureRoundedToWholePixel:s,add:o,subtract:u,multiply:a,divide:f,equals:l}}function w(e){return b(Math.round(e*Math.pow(10,r)))}function E(){return b(0)}function S(e,t){return b(Math.min(e.getRawMeasure(),t.getRawMeasure()))}function x(e,t){return b(Math.max(e.getRawMeasure(),t.getRawMeasure()))}function T(e){var t=e.length,n=0,s=0,o=e.indexOf(i);e=e.substr(0,e.length-2);if(o>=0){s=e.substring(o+1);while(s.length<r)s+=m;s=parseInt(s,10)}return o!==0&&(n=e.substring(0,o>=0?o:t),n=parseInt(n,10)*Math.pow(10,r)),b(n)}function N(e,t){var n=y(e,t),r=!1,i,m,b,w,E;if(!n.contains(s)){if(t.contains("border-width")){i=y(e,"border-style");if(i===v)n="0"+s,r=!0;else for(m in g)if(g.hasOwnProperty(m)&&i===m){n=g[m]+s,r=!0;break}}if(!r){b=n.contains(o),w=n.contains(u),E=n.contains(a);if(b||w)i=parseInt(y(b?e:document.body,"font-size"),10),n=parseInt(n,10)*i+s;else if(E){if(t.contains(l)||t.contains(c)||t.contains(h))m=e.parentNode.clientWidth;else if(t.contains(f)||t.contains(p)||t.contains(d))m=e.parentNode.clientHeight;n=Math.round(parseInt(n,10)/100*m)+s}}}return T(n)}var r=e.precision,i=e.PERIOD,s=e.PX,o=e.EM,u=e.REM,a=e.PERCENT,f=e.HEIGHT,l=e.WIDTH,c=e.LEFT,h=e.RIGHT,p=e.TOP,d=e.BOTTOM,v=e.NONE,m="0",g=t.borderWidths,y=n.getCssValue;return{create:b,measureFromPx:w,measureFromStyleProperty:N,zero:E,min:S,max:x}}),define("scalejs.layout-cssgrid/trackManager",["./consts","./enums","./objects"],function(e,t,n){var r=e.FR,i=t.sizingType,s=t.gridTrackValue,o=n.track,u=n.implicitTrackRange;return function(){function a(){function s(){e=!0,r=0,i=0}function o(){var e=null,s=!1,o=t.length,u=n.length;return r>=o?s=!0:i<u&&n[i].firstNumber<t[r].number&&(s=!0),s&&i<u?(e=n[i],i+=1):r<o&&(e=t[r],r+=1),e}var e=!0,r=0,i=0;return{reset:s,next:o}}function f(e){t.push(e)}function l(e){return e.firstNumber+e.span-1}function c(e){var t=0,r=n.length,i,s,o,u,a,f;for(t=0;t<r;t+=1){i=n[t],f=l(i);if(e>=i.firstNumber&&e<=f){s=t<r-1?null:n[t+1];if(e===i.firstNumber)i.span===1?n.splice(t,1):(i.firstNumber+=1,i.span-=1);else{if(e!==f)throw o=i.firstNumber,u=e-i.firstNumber,a=e+1,new Error("Not implemented");i.span-=1}break}}}function h(e){c(e);var n=0,r=t.length,u=o();u.number=e,u.sizingType=i.keyword,u.size=s.auto,u.implicit=!0;if(r===0||e>t[r-1].number)f(u);else if(e!==t[r-1].number)for(n=0;n<r;n+=1){if(e===t[n].number)break;if(e<t[n].number){t.splice(n,0,u);break}}}function p(e,r){var i=t.length,s=Math.min,o=Math.max,a,f,c,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M;h(e),e+=1;if(e<=r){a=[],f=e,c=r,i===0&&a.push({first:f,last:c});for(p=0;p<i;p+=1){if(f>c||t[p].number>c)break;t[p].number>=f&&t[p].number<=c&&(f===t[p].number?f+=1:c===t[p].number?c-=1:(a.push({first:f,last:t[p].number-1}),f=t[p].number+1))}f<=c&&a.push({first:f,last:c}),d=0,m=a.length;for(v=0;v<m;v+=1){y=a[v],b=y.first,w=y.last,E=!0,g=n.length;for(d=0;d<g;d+=1){S=n[d],x=S.firstNumber,T=l(S);if(w<x)break;if(b<=T){if(b===x&&w===T){E=!1;break}N=s(b,x),C=o(b,x)-N,k=N+C,L=s(w,T)-k,A=k+L,O=o(w,T)-A+1,C>0&&(M=u(),M.firstNumber=N,M.span=C,n.splice(d,0,M),d+=1),L>0&&(M=u(),M.firstNumber=k,M.span=L,n.splice(d,0,M),d+=1),O>0&&(M=u(),M.firstNumber=A,M.span=O,n.splice(d,0,M),d+=1),n.splice(d,1),E=!1;break}}E&&(M=u(),M.firstNumber=b,M.span=w-b+1,d>=n.length?n.push(M):n.splice(d,0,M))}}}function d(){return a()}function v(e){var r,i,s;for(i=t.length-1;i>=0;i-=1){if(t[i].number<e)break;if(e===t[i].number)return t[i]}i=n.length;for(r=0;r<i;r+=1){s=n[r].firstNumber+n[r].span-1;if(e>=n[r].firstNumber&&e<=s)return n[r]}}function m(e,r){var i=[],s,o,u,a;for(o=0,u=t.length;o<u;o+=1){s=t[o].number;if(s>r)break;s>=e&&s<=r&&i.push(t[o])}for(o=0,u=n.length;o<u;o+=1){a=n[o].firstNumber+n[o].span-1,e>=n[o].firstNumber&&r<=a&&i.push(n[o]);if(a>=r)break}return i.length===0&&console.log("getTracks: a track in the range "+e+" - "+r+" doesn't exist"),i}function g(e){return e.sizingType===i.valueAndUnit&&e.size.unit===r}function y(e,n){var r,i;for(r=e-1,i=t.length;r<i&&r<e+n-1;r+=1)if(g(t[r]))return!0;return!1}var t=[],n=[];return{tracks:t,addTrack:f,ensureTracksExist:p,getIterator:d,getTrack:v,getTracks:m,spanIsInFractionalTrack:y}}}),define("scalejs.layout-cssgrid/propertyParser",["./consts","./enums","./objects"],function(e,t,n){function v(e){var t=!1;switch(e){case c.auto.keyword:case c.minContent.keyword:case c.maxContent.keyword:case c.fitContent.keyword:t=!0}return t}function m(e){var t=/^(\d*\.?\d*)([\w\W]*)/,n=e.match(t),r=d();return n[0].length>0&&n[1].length>0&&n[2].length>0&&(n[1].indexOf(s)<0?r.value=parseInt(n[1],10):r.value=parseFloat(n[1],10),r.unit=n[2]),r}function g(e){var t=!1;switch(e){case o:case u:case"pt":case"pc":case"in":case"cm":case"mm":case a:case"ex":case"vh":case"vw":case"vm":case"ch":case f:case l:t=!0}return t}function y(e,t){var n=e.split(r),s=n.length,o,u,a;if(s===1&&(n[0].length===0||n[0].toLowerCase()===i))return;for(o=0;o<s;o+=1){n[o]=n[o].toLowerCase(),u=null;if(v(n[o]))u=p(),u.number=o+1,u.size=c.parse(n[o]),u.sizingType=h.keyword,t.addTrack(u);else{a=m(n[o]);if(a.value===null||a.unit===null)throw new Error("Not a keyword or a valid CSS value; track "+(o+1)+" = "+n[o]+'. Invalid track definition "'+n[o]+'"');if(!g(a.unit))throw new Error('Invalid track unit "'+a.unit+'"');u=p(),u.number=o+1,u.size=a,u.sizingType=h.valueAndUnit,t.addTrack(u)}}}var r=e.regexSpaces,i=e.NONE,s=e.PERIOD,o=e.PX,u=e.PERCENT,a=e.EM,f=e.REM,l=e.FR,c=t.gridTrackValue,h=t.sizingType,p=n.track,d=n.cssValueAndUnit;return{parseGridTracksString:y}}),define("scalejs.layout-cssgrid/boxSizeCalculator",["./consts","./utils","./layoutMeasure"],function(e,t,n){function b(e){var t=y(e,r),s=n.measureFromStyleProperty(e,i);s=s.add(n.measureFromStyleProperty(e,a+c+h)).add(n.measureFromStyleProperty(e,a+c+p)),t===d&&(s=s.add(n.measureFromStyleProperty(e,f+c+h)).add(n.measureFromStyleProperty(e,f+c+p)));if(t===d||t===v)y(e,l+c+h+m)!==g&&(s=s.add(n.measureFromStyleProperty(e,l+c+h+c+i))),y(e,l+c+p+m)!==g&&(s=s.add(n.measureFromStyleProperty(e,l+c+p+c+i)));return s}function w(e){var t=y(e,r),h=n.measureFromStyleProperty(e,s);h=h.add(n.measureFromStyleProperty(e,a+c+o)).add(n.measureFromStyleProperty(e,a+c+u)),t===d&&(h=h.add(n.measureFromStyleProperty(e,f+c+o)).add(n.measureFromStyleProperty(e,f+c+u)));if(t===d||t===v)y(e,l+c+o+m)!==g&&(h=h.add(n.measureFromStyleProperty(e,l+c+o+c+i))),y(e,l+c+u+m)!==g&&(h=h.add(n.measureFromStyleProperty(e,l+c+u+c+i)));return h}function E(e,t){var s=y(e,r),o=t;s===d&&(o=o.subtract(n.measureFromStyleProperty(e,f+c+h).add(n.measureFromStyleProperty(e,f+c+p))));if(s===d||s===v)y(e,l+c+h+m)!==g&&(o=o.subtract(n.measureFromStyleProperty(e,l+c+h+c+i))),y(e,l+c+p+m)!==g&&(o=o.subtract(n.measureFromStyleProperty(e,l+c+p+c+i)));return o=o.subtract(n.measureFromStyleProperty(e,a+c+h).add(n.measureFromStyleProperty(e,a+c+p))),o}function S(e,t){var s=y(e,r),h=t,p;s===d&&(h=h.subtract(n.measureFromStyleProperty(e,f+c+o).add(n.measureFromStyleProperty(e,f+c+u))));if(s===d||s===v)y(e,l+c+o+m)!==g&&(h=h.subtract(n.measureFromStyleProperty(e,l+c+o+c+i))),y(e,l+c+u+m)!==g&&(h=h.subtract(n.measureFromStyleProperty(e,l+c+u+c+i)));return h=h.subtract(n.measureFromStyleProperty(p,a+c+o).add(n.measureFromStyleProperty(p,a+c+u))),h}var r=e.BOXSIZING,i=e.WIDTH,s=e.HEIGHT,o=e.TOP,u=e.BOTTOM,a=e.MARGIN,f=e.PADDING,l=e.BORDER,c=e.HYPHEN,h=e.LEFT,p=e.RIGHT,d=e.CONTENTBOX,v=e.PADDINGBOX,m=e.STYLE,g=e.NONE,y=t.getCssValue;return{calcMarginBoxWidth:b,calcMarginBoxHeight:w,calcBoxWidthFromMarginBoxWidth:E,calcBoxHeightFromMarginBoxHeight:S}}),define("scalejs.layout-cssgrid/intrinsicSizeCalculator",["./consts","./enums","./objects","./utils","./boxSizeCalculator"],function(e,t,n,r,i){function T(e,t,n,r){S===null&&(S=E.cloneNode(!0),S.id="intrinsicSizeCalculator");var i=s,p=e.parentNode,d="font-",v=d+"family",m=d+"size",T=m+"-adjust",N=d+o,C=d+"style",k=d+"variant",L=d+"weight",A="direction";if(g(n)&&n!==null)i+=u+f+n.getPixelValue()+l+c;else switch(t){case t.minWidth:case t.maxHeight:i+=u+f+b.cssText+c;break;case t.minHeight:case t.maxWidth:i+=u+f+w.cssText+c;break;case t.shrinkToFit:}if(g(r)&&r!==null)i+=a+f+r.getPixelValue()+l+c;else switch(t){case t.minWidth:case t.maxHeight:i+=a+f+w.cssText+c;break;case t.minHeight:case t.maxWidth:i+=a+f+b.cssText+c;break;case t.shrinkToFit:}x=p===document.body?p:p.parentNode,x!==p&&(i+=v+f+y(p,v)+c+m+f+y(p,m)+c+T+f+y(p,T)+c+N+f+y(p,N)+c+C+f+y(p,C)+c+k+f+y(p,k)+c+L+f+y(p,L)+c+A+f+y(p,A)+c+h+f+y(p,h)+c),S.style.cssText+=i,x.appendChild(S)}function N(){x.removeChild(S)}function C(e){var t=e.cloneNode(!0);return t.style.cssText=t.style.cssText+c+"float:left",S.appendChild(t),t}function k(e){T(e,v.minWidth);var t=C(e),n=i.calcMarginBoxWidth(t);return S.removeChild(t),N(),n}function L(e){T(e,v.maxWidth);var t=C(e),n=i.calcMarginBoxWidth(t);return S.removeChild(t),N(),n}function A(e,t){if(!g(t)||t===null)throw new Error("No `usedWidth` specified.");T(e,v.minHeight,t);var n=C(e),r=i.calcMarginBoxHeight(n);return S.removeChild(n),N(),r}function O(e,t){if(!g(t)||t===null)throw new Error("No `usedWidth` specified");T(e,v.maxHeight,t);var n=C(e),r=i.calcMarginBoxHeight(n);return S.removeChild(n),N(),r}function M(e,t,n,r,s){r!==null&&(t=r),s!==null&&(n=s),T(e,v.shrinkToFit,t,n);var o=C(e),h=m(),g,y;return r!==null&&(g=i.calcBoxWidthFromMarginBoxWidth(o,r),o.style.cssText+=p+u+f+g.getPixelValueString()+l+c+d+u+f+g.getPixelValueString()+l+c),s!==null&&(y=i.calcBoxHeightFromMarginBoxHeight(o,s),o.style.cssText+=p+a+f+y.getPixelValueString()+l+c+d+a+f+y.getPixelValueString()+l+c),h.width=i.calcMarginBoxWidth(o),h.height=i.calcMarginBoxHeight(o),S.removeChild(o),N(),h}var s=e.EMPTY,o=e.STRETCH,u=e.WIDTH,a=e.HEIGHT,f=e.COLON,l=e.PX,c=e.SEMICOL,h=e.BLOCKPROGRESSION,p=e.MIN,d=e.MAX,v=t.calculatorOperation,m=n.widthAndHeight,g=r.defined,y=r.getCssValue,b={cssText:"0px"},w={cssText:"1000000px"},E=document.createElement("div"),S=null,x=null;return{calcMinWidth:k,calcMaxWidth:L,calcMinHeight:A,calcMaxHeight:O,calcShrinkToFitWidthAndHeight:M}}),define("scalejs.layout-cssgrid/gridLayout",["./consts","./enums","./objects","./utils","./layoutMeasure","./trackManager","./propertyParser","./boxSizeCalculator","./intrinsicSizeCalculator"],function(e,t,n,r,i,s,o,u,a){var f=e.BLOCKPROGRESSION,l=e.EMPTY,c=e.OPEN_CURLY,h=e.ABSOLUTE,p=e.CLOSE_CURLY,d=e.RELATIVE,v=e.STATIC,m=e.PERIOD,g=e.GRIDLAYOUT,y=e.GRIDCOLUMNS,b=e.GRIDROWS,w=e.GRIDCOLUMN,E=e.GRIDCOLUMNSPAN,S=e.GRIDROW,x=e.GRIDROWSPAN,T=e.GRIDROWALIGN,N=e.GRIDCOLUMNALIGN,C=e.NONE,k=e.TOP,L=e.RIGHT,A=e.BOTTOM,O=e.LEFT,M=e.INLINEGRID,_=e.MARGIN,D=e.HYPHEN,P=e.PADDING,H=e.BORDER,B=e.WIDTH,j=e.HEIGHT,F=e.AUTO,I=e.PX,q=e.FR,R=e.DISPLAY,U=e.COLON,z=e.SEMICOL,W=e.STYLE,X=e.BOXSIZING,V=e.MIN,$=e.MAX,J=e.POSITION,K=e.STRETCH,Q=e.precision,G=t.blockProgression,Y=t.position,Z=t.gridAlign,et=t.sizingType,tt=t.borderWidths,nt=G.parse,rt=Y.parse,it=Z.parse,st=t.gridTrackValue,ot=n.widthAndHeight,ut=n.item,at=r.getCssValue,ft=r.createBoundedWrapper,lt=r.defined,ct=r.makeUniqueClass,ht=r.addClass,pt=r.embedCss,dt=r.clearEmbeddedCss,vt=document.createElement("div");return function(t,n,r,mt,gt){function Lt(e,t,n,r){var s=yt.parentNode,o=e===B?O:k,u=e===B?L:A,a=e===B?s.offsetWidth:s.offsetHeight,f=i.measureFromStyleProperty(s,H+D+o+D+B),l=i.measureFromStyleProperty(s,H+D+u+D+B),c=i.measureFromStyleProperty(s,P+D+o),h=i.measureFromStyleProperty(s,P+D+u);return a-=f.getRawMeasure()+l.getRawMeasure()+c.getRawMeasure()+h.getRawMeasure()+t[o].getRawMeasure()+t[u].getRawMeasure()+r[o].getRawMeasure()+r[u].getRawMeasure()+n[o].getRawMeasure()+n[u].getRawMeasure(),a}function At(){return window.innerWidth-document.documentElement.clientWidth}function Ot(){return window.innerHeight-document.documentElement.clientHeight}function Mt(){return bt===G.lr||bt===G.rl}function _t(){var e=yt.cloneNode(!1),t=r,n=yt.parentNode,s,o="0px",u=[k,L,A,O],a={},f={},l={},c=yt.style.display,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C;s=t.display===M?!0:!1,u.forEach(function(e){a[e]=i.measureFromStyleProperty(yt,_+D+e),f[e]=i.measureFromStyleProperty(yt,P+D+e),l[e]=i.measureFromStyleProperty(yt,H+D+e+D+B)}),n.insertBefore(e,yt),yt.style.display="none",h=at(e,B),d=at(yt,"float"),h===o&&(h=F),h===F&&(s||d===O||d===L)&&(Nt=!0),p=at(e,j),p===o&&(p=F),p===F&&(Ct=!0),yt.style.display=c,n.removeChild(e),e=document.createElement(yt.tagName),v=h!==F?h:Lt(B,a,f,l)+I,m=p!==F?p:Lt(j,a,f,l)+I,g=R+U+(s?"inline-block":"block")+z+_+U+at(yt,_)+z+H+D+B+U+at(yt,H+D+B)+z+P+U+at(yt,P)+z+H+W+U+at(yt,H+W)+z+B+U+v+z+j+U+m+z+X+U+at(yt,X)+z+V+B+U+at(yt,V+B)+z+V+j+U+at(yt,V+j)+z+$+B+U+at(yt,$+B)+z+$+j+U+at(yt,$+j)+z,e.style.cssText=g,y=At(),b=Ot(),n.insertBefore(e,yt),w=n.removeChild(yt),E=h!==F?0:y-At(),S=p!==F?0:b-Ot(),x=i.measureFromStyleProperty(e,B),T=i.measureFromStyleProperty(e,j),N=i.measureFromPx(E),C=i.measureFromPx(S),Mt()?(wt=T.subtract(C),Et=x.subtract(N)):(wt=x.subtract(N),Et=T.subtract(C)),n.insertBefore(w,e),n.removeChild(e)}function Dt(e,t,n){e.ensureTracksExist(t,n)}function Pt(e,t,n,r){var i,s=e.tracks.length,o,u=e.implicitTracks;for(i=0;i<s;i+=1)if(e.tracks[i].number===n)e.tracks[i].items.push(t);else if(e.tracks[i].number>n)break;for(o=0;o<u;o+=1)n>=e.implicitTracks[o].firstNumber&&r<=e.implicitTracks[o].length&&e.implicitTracks[o].items.push(t)}function Ht(){St=gt.map(function(e){var t,n,r,i,s,o,u,a,f,c,h,p,d,v;return t=parseInt(e.details.properties[w],10),isNaN(t)&&(kt=!0,t=1),n=parseInt(e.details.properties[E],10),isNaN(n)&&(kt=!0,n=1),r=parseInt(e.details.properties[S],10),isNaN(r)&&(kt=!0,r=1),i=parseInt(e.details.properties[x],10),isNaN(i)&&(kt=!0,i=1),s=e.details.properties[N]||l,s.length===0&&(kt=!0),o=it(s),u=e.details.properties[T]||l,u.length===0&&(kt=!0),a=it(u),f=at(e.element,X),c=ut(),c.itemElement=e.element,c.styles=e.details,c.column=t,c.columnSpan=n,c.columnAlign=o,c.row=r,c.rowSpan=i,c.rowAlign=a,h=c.column,p=h+c.columnSpan-1,d=c.row,v=d+c.rowSpan-1,Dt(xt,h,p),Dt(Tt,d,v),Pt(xt,c,h,p),Pt(Tt,c,d,v),c})}function Bt(){St.forEach(function(e){e.position===null&&(e.position=rt(at(e.itemElement,J)))})}function jt(e,t){var n=!1;if((e===G.tb||e===G.bt)&&t===!0||(e===G.lr||e===G.rl)&&t===!1)n=!0;return n}function Ft(e,t){var n,r,s=vt.cloneNode(!0),o="margin:0px;border:0px;padding:0px;"+(t?N:T)+U+K+z+(t?w:S)+U+e+z;return s.style.cssText=o,s=yt.appendChild(s),n=nt(at(yt,f)),r=jt(n,t)?i.measureFromStyleProperty(s,B):i.measureFromStyleProperty(s,j),yt.removeChild(s),r}function It(e){var t=i.zero(),n=e.getIterator(),r=n.next();while(r!==null)t=t.add(r.measure),r=n.next();return t}function qt(e,t){var n=e.maxMeasure.subtract(e.measure),r=t.maxMeasure.subtract(t.measure);return n.getRawMeasure()<r.getRawMeasure()?-1:n.getRawMeasure()>r.getRawMeasure()?1:0}function Rt(e){return e.sizingType===et.valueAndUnit&&e.size.unit===q}function Ut(e,t,n){var r,s=e.getTracks(t,t+n-1);return r=s.reduce(function(e,t){return e.add(t.measure)},i.zero()),r}function zt(e){if(!Rt(e))throw new Error("getNormalFractionMeasure called for non-fraction sized track");var t=e.size.value;return t===0?i.zero():e.measure.divide(t)}function Wt(e,t){var n=0,r=zt(e),i=zt(t);return lt(e)&&lt(t)&&(r.getRawMeasure()<i.getRawMeasure()?n=-1:r.getRawMeasure()>i.getRawMeasure()?n=1:e.size.value>t.size.value?n=-1:e.size.value<t.size.value&&(n=1)),n}function Xt(e){var t=i.zero();return e.forEach(function(e){var n=e.size.value,r=e.maxMeasure.divide(n);r.getRawMeasure()>t.getRawMeasure()&&(t=r)}),t}function Vt(e){function r(t){t.usedWidthMeasure===null&&(t.usedWidthMeasure=Ut(e,t.column,t.columnSpan))}var t=e.getIterator(),n=t.next();while(n!==null)n.items.forEach(r),n=t.next()}function $t(e){var t=e.toLowerCase()===B,n=t?xt:Tt,r=t?wt:Et,s=t?Nt:Ct,o=[],u=[],f=[],l=!0,c=n.getIterator(),h=c.next(),p,d,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,j,F,R,U,z;s&&r.getRawMeasure()===0&&(l=!1);while(h!==null){if(h.sizingType!==et.keyword&&h.sizingType!==et.valueAndUnit)throw new Error("Unknown grid track sizing type");h.measure=i.zero(),h.minMeasure=i.zero(),h.maxMeasure=i.zero(),d=s&&Rt(h);if(h.sizingType===et.keyword||d){p=h.size;if(p!==st.fitContent&&p!==st.minContent&&p!==st.maxContent&&p!==st.auto&&!d)throw new Error("Unknown grid track sizing value "+p.keyword);d||(h.contentSizedTrack=!0);for(m=0,g=h.items.length;m<g;m+=1){y=h.items[m];if(y.position!==Y[v]&&y.position!==Y.relative)continue;if((t?y.columnSpan:y.rowSpan)>1)y.maxWidthMeasure===null&&(t?y.maxWidthMeasure=a.calcMaxWidth(y.itemElement):y.maxHeightMeasure=a.calcMaxHeight(y.itemElement,y.usedWidthMeasure)),(p===st.fitContent||p===st.auto)&&o.push(y);else{!d&&(p===st.minContent||p===st.fitContent||p===st.auto)&&(t?b=a.calcMinWidth(y.itemElement):b=a.calcMinHeight(y.itemElement,y.usedWidthMeasure),b.getRawMeasure()>h.minMeasure.getRawMeasure()&&(h.minMeasure=b));if(d||p===st.maxContent||p===st.auto)t?w=a.calcMaxWidth(y.itemElement):w=a.calcMaxHeight(y.itemElement,y.usedWidthMeasure),w.getRawMeasure()>h.maxMeasure.getRawMeasure()&&(h.maxMeasure=w)}}switch(p){case st.maxContent:E=Ft(h.number,t),h.measure=h.minMeasure=h.maxMeasure;break;case st.minContent:E=Ft(h.number,t),h.measure=h.maxMeasure=h.minMeasure;break;case st.fitContent:case st.auto:h.measure=h.minMeasure}}h.sizingType===et.keyword&&(h.size===st.auto||h.size===st.fitContent)&&u.push(h),h.sizingType===et.valueAndUnit&&(h.size.unit===I?h.measure=h.minMeasure=h.maxMeasure=i.measureFromPx(h.size.value):h.size.unit===q?(h.measure=i.zero(),f.push(h)):kt=!0),h=c.next()}A=It(n),S=r.subtract(A);if(S.getRawMeasure()>0){z=ft(qt),u.sort(z);for(x=0,T=u.length;x<T;x+=1){if(S.getRawMeasure()<=0)break;N=S.divide(u.length-x),N=i.min(N,u[x].maxMeasure.subtract(u[x].measure)),u[x].measure=u[x].measure.add(N),S=S.subtract(N)}}for(m=0,g=o.length;m<g&&S>0;m+=1){C=o[m],k=t?C.column:C.row,L=t?C.columnSpan:C.rowSpan;if(!n.spanIsInFractionalTrack(k,L))continue;A=Ut(n,k,L),O=(t===!0?C.maxWidthMeasure:C.maxHeightMeasure).subtract(A);if(O.getRawMeasure()>0)throw new Error("Not implemented")}if(f.length>0&&(S.getRawMeasure()>0||s)){z=ft(Wt),f.sort(z),M=0;for(m=0,g=f.length;m<g;m+=1)M+=f[m].size.value;_=null,s?_=Xt(f):_=S.divide(M),g=f.length;if(s){if(l){D=i.zero();for(m=0;m<g;m+=1)D=D.add(_.multiply(f[m].size.value));D.getRawMeasure()>0&&S.getRawMeasure()>0&&D.getRawMeasure()>S.getRawMeasure()&&(_=_.multiply(S.divide(D.getRawMeasure()).getRawMeasure()))}for(m=0;m<g;m+=1)f[m].measure=f[m].measure.add(_.multiply(f[m].size.value))}else if(g>0){P=zt(f[0]),H=0,j=0;for(m=0;m<g;m+=1){if(P.getRawMeasure()<zt(f[m]).getRawMeasure()){j=H,F=zt(f[m]).subtract(P);for(R=0;R<m;R+=1)U=0,j>0&&(U=S.multiply(f[R].size.value).divide(j),U=i.min(U,F.multiply(f[R].size.value)),U=i.min(U,f[R].maxMeasure)),f[R].measure=f[R].measure.add(U),S-=U,j-=f[R].size.value;P=zt(f[m])}H+=f[m].size.value;if(S.getRawMeasure()<=0)break}j=H;for(m=0;m<g;m+=1)U=0,j>0&&(U=S.multiply(f[m].size.value/j)),f[m].measure=f[m].measure.add(U),S=S.subtract(U),j-=f[m].size.value}}t&&Vt(n)}function Jt(){var e,t=St.length,n,r,i,s,o=null,u=null;for(e=0;e<t;e+=1){n=St[e];if(n.shrinkToFitSize===null){r=Ut(xt,n.column,n.columnSpan),i=Ut(Tt,n.row,n.rowSpan);if(n.position===Y[v]||n.position===Y.relative)s=Mt(),n.columnAlign===Z.stretch&&(s?u=r:o=r),n.rowAlign===Z.stretch&&(s?o=i:u=i);o===null||u===null?n.shrinkToFitSize=a.calcShrinkToFitWidthAndHeight(n.itemElement,r,i,o,u):n.shrinkToFitSize=ot(),o!==null&&(n.shrinkToFitSize.width=o),u!==null&&(n.shrinkToFitSize.height=u)}}}function Kt(){var e=vt.cloneNode(!1),t=H+D+L,n,r;document.body.appendChild(e),e.style.width="100px",n=parseInt(e.offsetWidth,10);for(r in tt)tt.hasOwnProperty(r)&&(e.style[t]=r+" solid",tt[r]=parseInt(e.offsetWidth,10)-n);document.body.removeChild(e)}function Qt(e){var t=e.column-1,n=e.row-1,r={top:0,left:0};return r.left=xt.tracks.slice(0,t).reduce(function(e,t){return e+t.measure.getRawMeasure()},0),r.top=Tt.tracks.slice(0,n).reduce(function(e,t){return e+t.measure.getRawMeasure()},0),r.left+=I,r.top+=I,r}function Gt(e){var t=e.shrinkToFitSize,n=e.itemElement,r={},s={},o={},u=[k,L,A,O];return t={height:t.height.getRawMeasure(),width:t.width.getRawMeasure()},u.forEach(function(e){r[e]=i.measureFromStyleProperty(n,_+D+e),s[e]=i.measureFromStyleProperty(n,P+D+e),o[e]=i.measureFromStyleProperty(n,H+D+e+D+B)}),t.height-=r.top.getRawMeasure()+r.bottom.getRawMeasure()+s.top.getRawMeasure()+s.bottom.getRawMeasure()+o.top.getRawMeasure()+o.bottom.getRawMeasure(),t.width-=r.left.getRawMeasure()+r.right.getRawMeasure()+s.left.getRawMeasure()+s.right.getRawMeasure()+o.left.getRawMeasure()+o.right.getRawMeasure(),t}function Yt(){var e=l,r=l,i=0,s=0,o=Tt.tracks,u=xt.tracks;St.forEach(function(t){var n=t.styles,r=t.itemElement.className,i=ct(),s,o,u;s=new RegExp(g+"-\\d*\\s?","g"),t.itemElement.className=r.replace(s,""),ht(t.itemElement,i),o=Qt(t),u=Gt(t),e+=n.selector+m+i+c+J+U+h+z,e+=k+U+o.top+z,e+=O+U+o.left+z,e+=B+U+u.width+I+z,e+=j+U+u.height+I+z,e+=p}),at(yt,J)===v&&(r+=J+U+d+z),i=o.reduce(function(e,t){return e+t.measure.getRawMeasure()},0),r+=j+U+i+I+z,s=u.reduce(function(e,t){return e+t.measure.getRawMeasure()},0),r+=B+U+s+I+z,e+=n+c+r+p,pt(e,mt,t.id)}function Zt(){dt(mt,t.id)}function en(){var e=r[y]||C,t=r[b]||C;_t(),o.parseGridTracksString(e,xt),o.parseGridTracksString(t,Tt),Ht(),Bt(),$t(B),$t(j),Jt(),Kt()}function tn(e){var t=e?xt:Tt,n=jt(bt,e),r=n?"Width":"Height";St.forEach(function(s){var o=s.itemElement,a,f,c,h,p,d,v,m,g;if((e?s.verified.columnBreadth:s.verified.rowBreadth)!==!0){a=e?s.column:s.row,f=e?s.columnAlign:s.rowAlign,c=u["calcMarginBox"+r](o),h=l,s.itemElement.id.length>0&&(h="[ID = "+s.itemElement.id+"] "),p=s.itemElement["offset"+r],d=i.measureFromPx(p),c.getMeasureRoundedToWholePixel().equals(d)!==!0&&(kt=!0);if(s.position===Y.absolute){if(s.shrinkToFitSize===null)throw new Error("Current item's shrink to fit size has not been calculated");v=n?s.shrinkToFitSize.width:s.shrinkToFitSize.height}else switch(f){case Z.stretch:m=e?s.column:s.row,g=e?s.columnSpan:s.rowSpan,v=Ut(t,m,g);break;case Z.start:case Z.end:case Z.center:if(s.shrinkToFitSize===null)throw new Error("Current item's shrink to fit size has not been calculated");v=n?s.shrinkToFitSize.width:s.shrinkToFitSize.height;break;default:throw new Error("Unknown grid align type "+f.keyword)}v.equals(c)!==!0&&Q===0&&Math.abs(v.subtract(c).getRawMeasure())!==1&&(kt=!0),e?s.verified.columnBreadth=!0:s.verified.rowBreadth=!0}})}var yt=t,bt=nt(at(t,f)),wt=null,Et=null,St=null,xt=s(),Tt=s(),Nt=!1,Ct=!1,kt=!1;return Zt(),en(),Yt(),{verifyGridItemLengths:tn}}}),define("scalejs.layout-cssgrid/cssGridLayout",["scalejs!core","./utils.sheetLoader","./gridLayout"],function(e,t,n){function s(){i.forEach(function(e){var t=e.selector,i,s=e.properties,o,u;i=document.getElementById(e.selector.substring(1));if(i===null)return;u=i.getAttribute("style"),u!==null&&u.split("; ").forEach(function(e){var t=e.split(":"),n;t.length===2&&(e=t[0].trim(),n=t[1].trim(),e.indexOf("-ms-grid")===0&&(s[e.substring(4)]=n))}),Object.keys(s).forEach(function(e){i.setAttribute("data-ms-"+e,s[e])}),o=r.filter(function(t){return t!==e}).map(function(e){var t={},n,r;r=document.getElementById(e.selector.substring(1));if(r===null||r.parentNode!==i)return;return t.element=r,t.details=e,n=t.element.getAttribute("style"),n!==null&&n.split(";").forEach(function(e){var n=e.split(":"),r;n.length===2&&(e=n[0].trim(),r=n[1].trim(),e.indexOf("-ms-grid")===0&&(t.details.properties[e.substring(4)]=r))}),Object.keys(t.details.properties).forEach(function(e){t.element.setAttribute("data-ms-"+e,t.details.properties[e])}),t}).filter(function(e){return e}),n(i,t,s,"screen",o)})}var r,i;return function(){var o=e.reactive.messageBus;t.loadAllStyleSheets(function(e){r=Object.keys(e).reduce(function(t,n){var r=e[n];return t.concat(r.rulelist)},[]).filter(function(e){var t=e.declarations;return e.type!=="style"||!t?!1:Object.keys(t).some(function(e){return e.indexOf("-ms-grid")===0})}).map(function(e){var t={};return t.selector=e.selector,t.media="screen",t.properties={},Object.keys(e.declarations).forEach(function(n){var r=e.declarations[n];n.indexOf("-ms-grid")===0?t.properties[n.substring(4)]=r:n==="display"&&r==="-ms-grid"?t.properties.display="grid":t.properties[n]=r}),t}),i=r.filter(function(e){return e.properties.display==="grid"}),s(),o.receive("css-grid-layout",function(){s()}),window.addEventListener("resize",function(){s()})})}}),define("scalejs.layout-cssgrid",["CSS.supports","./scalejs.layout-cssgrid/cssGridLayout","scalejs.reactive"],function(e,t){e.supports("display","-ms-grid")||t()});